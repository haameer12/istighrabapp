<!DOCTYPE html>
<!--HTML5 doctype-->
<html>

<head>

    <title>test</title>
    <meta http-equiv="Content-type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=0, minimal-ui" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <META HTTP-EQUIV="Pragma" CONTENT="no-cache">
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <link rel="stylesheet" type="text/css" href="engine/build/icons.css" />

    <link rel="stylesheet" type="text/css" href="engine/build/af.ui.css" />

	<link rel="stylesheet" type="text/css" href="engine/third-party/animate.css" />
	<link rel="stylesheet" href="engine/third-party/font-awesome/css/font-awesome.min.css" />
    <script type="text/javascript" charset="utf-8" src="engine/third-party/jquery.min.js"></script>
    <script type="text/javascript" charset="utf-8" src="engine/third-party/fastclick.js"></script>
	<script type="text/javascript" src="engine/third-party/jquery.noty.packaged.js"></script>
	
	<link rel="stylesheet" href="engine/third-party/nanoScrollerJS/bin/css/nanoscroller.css">
	<script src="engine/third-party/nanoScrollerJS/bin/javascripts/jquery.nanoscroller.js"></script>
	<script src="engine/third-party/nanoScrollerJS/bin/javascripts/overthrow.min.js"></script>
	
	<script type="text/javascript" charset="utf-8" src="cordova.js"></script>
	
    <script type="text/javascript" charset="utf-8" src="engine/src/af.shim.js"></script>
    <script type="text/javascript" charset="utf-8" src="engine/src/af.ui.js"></script>


   										   <script src="engine/src/af.desktopBrowsers.js"></script>
    <script type="text/javascript" charset="utf-8" src="engine/src/af.actionsheet.js"></script>
    <script type="text/javascript" charset="utf-8" src="engine/src/af.animation.js"></script>
    <script type="text/javascript" charset="utf-8" src="engine/src/af.touchEvents.js"></script>
    <script type="text/javascript" charset="utf-8" src="engine/src/af.popup.js"></script>
    <script type="text/javascript" charset="utf-8" src="engine/src/af.drawer.js"></script>
    <script type="text/javascript" charset="utf-8" src="engine/src/af.toast.js"></script>
    <script type="text/javascript" charset="utf-8" src="engine/src/af.animateheader.js"></script>
    <script type="text/javascript" charset="utf-8" src="engine/src/af.splashscreen.js"></script>
    <script type="text/javascript" charset="utf-8" src="engine/src/af.swipereveal.js"></script>
	
	


    <script>
    $.afui.useOSThemes=false;
    $.afui.loadDefaultHash=true;
    $.afui.autoLaunch=false;

    //check search
    var search=document.location.search.toLowerCase().replace("?","");
    if(search.length>0)
    {

       $.afui.useOSThemes=true;
        if(search=="win8")
            $.os.ie=true;
        else if(search=="firefox")
            $.os.fennec="true"
        $.afui.ready(function(){
            $(document.body).get(0).className=(search);
        });
    }

    $(document).ready(function(){
        $.afui.launch();
    });

    //if($.os.ios)
        $.afui.animateHeader(true);
		
	
	
	
/*	$(document).on('pageinit', '.ui-page', function (event, data){
	   FastClick.attach(activePage);
	});*/
	
	/*---------------my func--------------*/
	function openUrl(url, name) {
		//window.open(url, '_system', 'location=yes');
		window.open(url, '_'+name, 'location=yes');
	}
	
	/*function nlTObr(text){
		return text.split("\n").join("<br />");
	}*/
	
	function nl2br(str, isXhtml){
	  //  discuss at: http://locutus.io/php/nl2br/
	  // original by: Kevin van Zonneveld (http://kvz.io)
	  // improved by: Philip Peterson
	  // improved by: Onno Marsman (https://twitter.com/onnomarsman)
	  // improved by: Atli Þór
	  // improved by: Brett Zamir (http://brett-zamir.me)
	  // improved by: Maximusya
	  // bugfixed by: Onno Marsman (https://twitter.com/onnomarsman)
	  // bugfixed by: Kevin van Zonneveld (http://kvz.io)
	  // bugfixed by: Reynier de la Rosa (http://scriptinside.blogspot.com.es/)
	  //    input by: Brett Zamir (http://brett-zamir.me)
	  //   example 1: nl2br('Kevin\nvan\nZonneveld')
	  //   returns 1: 'Kevin<br />\nvan<br />\nZonneveld'
	  //   example 2: nl2br("\nOne\nTwo\n\nThree\n", false)
	  //   returns 2: '<br>\nOne<br>\nTwo<br>\n<br>\nThree<br>\n'
	  //   example 3: nl2br("\nOne\nTwo\n\nThree\n", true)
	  //   returns 3: '<br />\nOne<br />\nTwo<br />\n<br />\nThree<br />\n'
	  //   example 4: nl2br(null)
	  //   returns 4: ''
	  // Some latest browsers when str is null return and unexpected null value
	  if (typeof str === 'undefined' || str === null) {
		return ''
	  }
	  // Adjust comment to avoid issue on locutus.io display
	  var breakTag = (isXhtml || typeof isXhtml === 'undefined') ? '<br ' + '/>' : '<br>'
	  return (str + '')
		.replace(/(\r\n|\n\r|\r|\n)/g, breakTag + '$1')
	}
	
	function addslashes(str){
	  //  discuss at: http://locutus.io/php/addslashes/
	  // original by: Kevin van Zonneveld (http://kvz.io)
	  // improved by: Ates Goral (http://magnetiq.com)
	  // improved by: marrtins
	  // improved by: Nate
	  // improved by: Onno Marsman (https://twitter.com/onnomarsman)
	  // improved by: Brett Zamir (http://brett-zamir.me)
	  // improved by: Oskar Larsson Högfeldt (http://oskar-lh.name/)
	  //    input by: Denny Wardhana
	  //   example 1: addslashes("kevin's birthday")
	  //   returns 1: "kevin\\'s birthday"
	  return (str + '')
		.replace(/[\\"']/g, '\\$&')
		.replace(/\u0000/g, '\\0')
	}

	function stripslashes(str){
	  //       discuss at: http://locutus.io/php/stripslashes/
	  //      original by: Kevin van Zonneveld (http://kvz.io)
	  //      improved by: Ates Goral (http://magnetiq.com)
	  //      improved by: marrtins
	  //      improved by: rezna
	  //         fixed by: Mick@el
	  //      bugfixed by: Onno Marsman (https://twitter.com/onnomarsman)
	  //      bugfixed by: Brett Zamir (http://brett-zamir.me)
	  //         input by: Rick Waldron
	  //         input by: Brant Messenger (http://www.brantmessenger.com/)
	  // reimplemented by: Brett Zamir (http://brett-zamir.me)
	  //        example 1: stripslashes('Kevin\'s code')
	  //        returns 1: "Kevin's code"
	  //        example 2: stripslashes('Kevin\\\'s code')
	  //        returns 2: "Kevin\'s code"
	  return (str + '')
		.replace(/\\(.?)/g, function (s, n1) {
		  switch (n1) {
			case '\\':
			  return '\\'
			case '0':
			  return '\u0000'
			case '':
			  return ''
			default:
			  return n1
		  }
		})
	}
	
	//show notification
	function notify(text, type, duration, pos, animateIn, animateOut){
/*		var n = noty({
			text: text,
			type: type,
			dismissQueue: true,
			layout: pos,
			theme: 'defaultTheme',
			animation: {
			open: {opacity: 'toggle'},
			close: {opacity: 'toggle'},
			easing: 'swing',
			speed: 700
			},
			timeout: duration,
			modal: false
		});
		return n;*/
		
		
		
		
		var n = noty({
			text         : text,
			type         : type,
			dismissQueue : true,
			layout       : pos,
			closeWith    : ['click'],
			theme        : 'relax',
			maxVisible   : 10,
			timeout      : duration,
			animation    : {
				open       : 'animated bounceIn'+animateIn,
				close      : 'animated bounceOut'+animateOut,
				easing     : 'swing',
				speed      : 500,
			}
		});
		return n;
	}
	
	//close notification
/*	function close_notify(witch){
		if(witch == "all"){
			$.noty.closeAll();
		}else{}
	}*/
    </script>
	

	<script type="text/javascript" charset="utf-8">
	////////////////////////////////////////////////////////////////////////////////////////////
	////////////////////////////////////////////////////////////////////////////////////////////
	// START push Notification :////////////////////////////////////////////////////////////////
	function onNotificationGCM(e){
		$("#app-status-ul").append('<li>EVENT -> RECEIVED:' + e.event + '</li>');

		switch(e.event){
		case 'registered':
			if( e.regid.length > 0){
			///Android
				$("#app-status-ul").append('<li>REGISTERED -> REGID:' + e.regid + "</li>");
				// Your GCM push server needs to know the regID before it can push to this device
				// here is where you might want to send it the regID for later use.
				$.ajax({
					type: "POST",
					url: "http://192.168.1.100/set_phone_key.php",
					data: {regID : e.regid,user:device.uuid,OS:device.platform},
					async: false,
					success : function(text){
						//last_articles_version = text;
						$("#app-status-ul").append('<li>EVENT -> RECEIVED: Rgister to server is finished : ' + text + '</li>');
						console.log('SMGROUP ::::::::::::::::::::::::::::::::::::    Notification registration text : ' + text);
					}
				});
			}
		break;

		case 'message':
			// if this flag is set, this notification happened while we were in the foreground.
			// you might want to play a sound to get the user's attention, throw up a dialog, etc.
			if(e.foreground){
				
				$("#app-status-ul").append('<li>--INLINE NOTIFICATION--' + '</li>');
				//must have vibration
				
				//notify(e.payload.message, 'information', 8000, 'topCenter');
				notify('<div class="activity-item"> <i class="fa fa-shopping-cart text-success"></i> <div class="activity"> <a href="#">Eugene</a> ' +e.payload.message +' <a href="#">OEM license</a> <span>14 minutes ago</span> </div> </div>', 'information', 8000, 'top', 'Left', 'Right');

				// if the notification contains a soundname, play it.
				//var my_media = new Media("/android_asset/www/"+e.soundname);
				//my_media.play();
				
			}else{  // otherwise we were launched because the user touched a notification in the notification tray.
				
				if(e.coldstart){
					$("#app-status-ul").append('<li>--COLDSTART NOTIFICATION--' + '</li>');
					window.alert('coldstart');
				}else{
					$("#app-status-ul").append('<li>--BACKGROUND NOTIFICATION--' + '</li>');
					window.alert('background');
				}
				
			}
			
			//alert(e.payload.message);
			/*navigator.notification.alert(
				e.payload.message +' - ' +e.payload.msgcnt,  // message
				"",                 // callback
				'اشعار',            // title
				'موافق'             // buttonName
			);*/
			//alert(e.payload.msgcnt);
			
			$("#app-status-ul").append('<li>MESSAGE -> MSG: ' + e.payload.message + '</li>');
			$("#app-status-ul").append('<li>MESSAGE -> MSGCNT: ' + e.payload.msgcnt + '</li>');
			
		break;

		case 'error':
			$("#app-status-ul").append('<li>ERROR -> MSG:' + e.msg + '</li>');
		break;

		default:
			$("#app-status-ul").append('<li>EVENT -> Unknown, an event was received and we do not know what it is</li>');
		break;
	  }
	}
	function successHandler(result){
		//alert('result = ' + result);
		$("#app-status-ul").append('<li>REGISTERED -> result = ' + result + "</li>");

	}
	// result contains any error description text returned from the plugin call
	function errorHandler(error){
		//alert('error = ' + error);
		$("#app-status-ul").append('<li>REGISTERED -> error = ' + error + "</li>");
	}
	// END push Notification ///////////////////////////////////////////////////////////////////
	////////////////////////////////////////////////////////////////////////////////////////////
	////////////////////////////////////////////////////////////////////////////////////////////
	
	
	
	/*----------------------------------------------------------------------------------------*/



	function init(){           
		console.log('SMGROUP ::::::::::::::::::::::::::::::::::::    start init()');
		document.addEventListener("deviceready", onDeviceReady, false);
	}
	
	var magNumArray = ["۰", "١", "٢", "٣", "٤", "٥", "٦", "٧", "٨", "٩", "١۰", "١١", "١٢", "١٣", "١٤", "١٥", "١٦", "١٧", "١٨", "١٩", "٢۰", "٢١", "٢٢", "٢٣", "٢٤", "٢٥", "٢٦", "٢٧", "٢٨", "٢٩", "٣۰", "٣١", "٣٢", "٣٣", "٣٤", "٣٥", "٣٦", "٣٧", "٣٨", "٣٩", "٣", "٤۰", "٤١", "٤٢", "٤٣", "٤٤", "٤٥", "٤٦", "٤٧", "٤٨", "٤٩", "٥۰", "٥١", "٥٢", "٥٣", "٥٤", "٥٥", "٥٦", "٥٧", "٥٨", "٥٩", "٦۰", "٦١", "٦٢", "٦٣", "٦٤", "٦٥", "٦٦", "٦٧", "٦٨", "٦٩", "٧۰", "٧١", "٧٢", "٧٣", "٧٤", "٧٥", "٧٦", "٧٧", "٧٨", "٧٩", "٨۰", "٨١", "٨٢", "٨٣", "٨٤", "٨٥", "٨٦", "٨٧", "٨٨", "٨٩", "٩۰", "٩١", "٩٢", "٩٣", "٩٤", "٩٥", "٩٦", "٩٧", "٩٨", "٩٩", "١۰۰"];
	var myDB = null;
	var isRowExisted = 0;
	function onDeviceReady() {
		
		
		
		
		if(navigator.connection.type==0){
			window.alert('This application requires internet. Please connect to the internet.');
		}else if(navigator.connection.type=='none'){
			window.alert('This application requires internet. Please connect to the internet.');
		}else{
			window.alert("Hurray I'm online");
		}
		
		
		
		
		setInterval(function(){
			statusbarTransparent.enable();
			StatusBar.show();
		}, 5000);
		
		
/*		
		//FastClick.attach(document.body);
		  
		console.log('SMGROUP ::::::::::::::::::::::::::::::::::::    start onDeviceReady');
			
	////////////////////////////////////////////////////////////////////////////////////////////
	////////////////////////////////////////////////////////////////////////////////////////////
	// START push Notification :////////////////////////////////////////////////////////////////
		pushNotification = window.plugins.pushNotification;

		console.log('SMGROUP ::::::::::::::::::::::::::::::::::::    register_for_notifs : no // ' + device.platform);
		if(device.platform == 'android' || device.platform == 'Android' || device.platform == "amazon-fireos"){
			pushNotification.register(successHandler,errorHandler,{"senderID":"1069136326484","ecb":"onNotificationGCM"});
		}else{
			pushNotification.register(tokenHandler,errorHandler,{"badge":"true","sound":"true","alert":"true","ecb":"onNotificationGCM"});//"onNotificationAPN"});
		}
		
		
		//iPhone
		function tokenHandler(result){
			console.log('SMGROUP ::::::::::::::::::::::::::::::::::::    Notification Callback Success! Result (ios) = '+result);
			$.ajax({
				type: "POST",
				url: "http://192.168.1.100/set_phone_key.php", 
				data: {regID : result,user:device.uuid,OS:device.platform},
				async: false,
				success : function(text){
					console.log('SMGROUP ::::::::::::::::::::::::::::::::::::    Notification registration text : ' + text);
				}
			});
		}
	// END push Notification ///////////////////////////////////////////////////////////////////
	////////////////////////////////////////////////////////////////////////////////////////////
	////////////////////////////////////////////////////////////////////////////////////////////
	
	
	
	
*/	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
//window.alert("on device ready worked");
/*myDB = window.sqlitePlugin.openDatabase({name: "offline-database.db", createFromLocation: 1});*/
myDB = window.sqlitePlugin.openDatabase({name: 'offline-database.db', location: 'default'});

myDB.transaction(function(transaction) {

	//window.alert("db worked");
	transaction.executeSql('CREATE TABLE IF NOT EXISTS istighrab_mag ( \
		"id"             INTEGER, \
		"sort"           INTEGER, \
		"name"           TEXT, \
		"protected"      INTEGER, \
		"pdf_path"       TEXT, \
		"mag_num_title"	 TEXT \
	)', [],
	function(tx, result) {
		//window.alert("Table created successfully");
	},
	function(error) {
		//window.alert("Error occurred while creating the table.");
	});
	
	
	
	transaction.executeSql('CREATE TABLE IF NOT EXISTS istighrab_mag_text ( \
		"mag_id"         INTEGER, \
		"text"	         TEXT \
	)', [],
	function(tx, result) {
		//window.alert("text table created successfully");
	},
	function(error) {
		//window.alert("Error occurred while creating the text table.");
	});
	
	
	
	transaction.executeSql('CREATE TABLE IF NOT EXISTS istighrab_mag_investigations ( \
		"id"                INTEGER, \
		"mag_id"            INTEGER, \
		"inve_title"        TEXT, \
		"inve_author"       TEXT, \
		"inve_file_path"    TEXT, \
		"inve_text"	        TEXT \
	)', [],
	function(tx, result) {
		//window.alert("inve table created successfully");
	},
	function(error) {
		//window.alert("Error occurred while creating the inve table.");
	});
	
	
	
	
	
	
	
	
/*	
	
	
	transaction.executeSql("INSERT INTO istighrab_mag (id, sort, name, protected, pdf_path, mag_num_title) VALUES (?, ?, ?, ?, ?, ?)", ["1", "", "1", "0", "files/files/5a3f38r.pdf", "كانط رؤية نقدية"],
	function(tx, result) {
		window.alert("Inserted");
	},
	function(error){
		window.alert("Error occurred");
	});
	
	
	
	transaction.executeSql("select count(id) as cnt from istighrab_mag;", [],
	function(tx, result) {
		window.alert("Rows num is : " + result.rows.length +" --- " +result.rows.item(0).cnt);
	},
	function(error){
		window.alert("Error occurred");
	});
	
	
	
	
	transaction.executeSql("select * from istighrab_mag;", [],
	function(tx, result) {
		
		window.alert(result.rows.length);
		var i = 0;
		while(result.rows.item(i)){
			window.alert(result.rows.item(i).mag_num_title);
			i++;
		}
		//$.each(result.rows, function( key, val ) {
			//window.alert(val.title);
			//$("#TableData").append("<tr><td>"+val.id+"</td><td>"+val.title+"</td><td>"+val.desc+"</td></tr>");
		//});
		//$.each(result.rows.item(2), function( key, value ) {
		  //alert( key + ": " + value );
		//});

	},
	function(error){
		window.alert("Error occurred in select");
	});

	
*/
	

});
	
	
	

//الكود الخاص بتحميل اول وجبه عند فتح البرنامج
myDB.transaction(function(transaction){
	
	var limit = 6;
	transaction.executeSql(
		"SELECT id, sort, name, protected, pdf_path, mag_num_title FROM istighrab_mag ORDER BY sort DESC, id DESC LIMIT ?",
		[limit],
		function(tx, result){
			
			if(result.rows.length < 1){//لا توجد في قاعدة بيانات البرنامج اي معلومه

				getMagRequestObj = $.ajax({
					type : 'get',
					url : "http://istighrab.iicss.iq/app/json_istighrab_mag.php?item_num=6",
					async : false,
					jsonpCallback : "istighrabMagCallBack",
					contentType : "application/json",
					dataType : 'jsonp',
					success : function(json){

						$.each(json, function(key, val){
				
							myDB.transaction(function(transaction){

								transaction.executeSql("INSERT INTO istighrab_mag (id, sort, name, protected, pdf_path, mag_num_title) VALUES (?, ?, ?, ?, ?, ?)", [val['id'], val['sort'], val['name'], val['protected'], val['pdf_path'], val['mag_num_title'] ],
								function(tx, result) {
									//window.alert("Inserted");

									$("#magListCon").attr("lastMagInListSortNum", val['sort']);
									if(key < 1){$("#magListCon").attr("firstMagInListSortNum", val['sort'])}
									$("#magListCon").append('<div class="mag_item" magID="' +val['id'] +'"> \
										<div class="mag_item_in"> \
											<div class="mag-name"> \
												<img class="mag-name-logo" src="img/mag-list-logo.png" /> \
												<div class="mag-name-num">' +magNumArray[val['name']] +'</div> \
											</div> \
											<div class="mag-title-middle-holder">&nbsp;</div> \
											<div class="mag-title"> \
											' +((val['mag_num_title'] != null)? "ملف العدد : " +val['mag_num_title'] :  "&nbsp;") +' \
											</div> \
											<a class="mag-download fa fa-cloud-download" aria-hidden="true" href="#" onclick="openUrl(\'http://istighrab.iicss.iq/' +val['pdf_path'] +'\', \'system\');return false;"></a> \
											<div class="mag-details-up-arrow under"></div><div class="mag-details-up-arrow"></div> \
										</div> \
										<div class="mag-details"> \
											<div class="mag-details-top-button"> \
												<a href="#" class="magInfoButton"><i class="fa fa-align-right" aria-hidden="true"></i> <span>تفاصيل العدد</span></a> \
												<a href="#" class="magInveButton"><i class="fa fa-pencil-square-o" aria-hidden="true"></i> <span>ابحاث العدد</span></a> \
											</div> \
											<div class="mag-taqarir" style="display:none"> \
 \
												<table class="HHH-table"> \
													<thead> \
														<tr> \
															<th>عنوان البحث</th> \
															<th>الباحث</th> \
															<th>تحمیل</th> \
														</tr> \
													</thead> \
													<tbody id="magInveCon' +val['id'] +'"></tbody> \
												</table> \
 \
											</div> \
											<div class="mag-info"> \
 \
												<div class="mag-info-win"> \
													<div class="mag-info-win-title">معلومات العدد</div> \
													<div class="mag-info-win-text" id="magTextCon' +val['id'] +'"></div> \
												</div> \
 \
											</div> \
										</div> \
									</div>');

									if((key+1) == json.length){
									
										$(".istighrab_mag_list .nano").nanoScroller();
										
										$(".magInfoButton").unbind("tap");
										$(".magInfoButton").bind("tap",function(){
											$(this).parent().siblings("div.mag-info").slideDown();
											$(this).parent().siblings("div.mag-taqarir").slideUp();
											return false;
										});
										
										$(".magInveButton").unbind("tap");
										$(".magInveButton").bind("tap",function(){
											$(this).parent().siblings("div.mag-taqarir").slideDown();
											$(this).parent().siblings("div.mag-info").slideUp();
											return false;
										});
										
										$(".mag_item_in").unbind("tap");
										$(".mag_item_in").bind("tap",function(){

											//window.alert("ok2");
											
											var tapedMag = $(this).parent();
											var tapedMagID = tapedMag.attr("magID");
				
											var isMagOpened = tapedMag.hasClass("mag-opened");
											$(".mag_item_in").parent().removeClass("mag-opened");
											if(!isMagOpened){
												tapedMag.addClass("mag-opened");
											}else{
												return false;
											}
											
											/////////////////////////////////////we are here
											myDB.transaction(function(transaction){
												
												transaction.executeSql(
													"SELECT id, inve_title, inve_author, inve_file_path FROM istighrab_mag_investigations WHERE mag_id = ? ORDER BY id ASC",
													[tapedMagID],
													function(tx, result){
														
														if(result.rows.length < 1){//لا توجد في قاعدة بيانات البرنامج اي معلومه
											
															getMagInveRequestObj = $.ajax({
																type : 'get',
																url : "http://istighrab.iicss.iq/app/json_istighrab_mag_inve_items.php?mag_id=" +tapedMagID,
																async : false,
																jsonpCallback : "istighrabMagInveCallBack",
																contentType : "application/json",
																dataType : 'jsonp',
																success : function(json){
											
																	$.each(json, function(key, val){
															
																		myDB.transaction(function(transaction){
											
																			transaction.executeSql("INSERT INTO istighrab_mag_investigations (id, mag_id, inve_title, inve_author, inve_file_path) VALUES (?, ?, ?, ?, ?)", [val['id'], tapedMagID, val['inve_title'], val['inve_author'], val['inve_file_path']],
																			function(tx, result) {
																				//window.alert("Inserted");
											
																				$("#magInveCon" +tapedMagID).append('<tr> \
																					<td><a href="#">' +val['inve_title'] +'</a></td> \
																					<td><a href="#">' +val['inve_author'] +'</a></td> \
																					<td><a href="#" onclick="openUrl(\'http://istighrab.iicss.iq/files/investigations/' +val['inve_file_path'] +'\', \'system\');return false;"><i class="fa fa-download" aria-hidden="true"></i></a></td> \
																				</tr>');
																				
																			},
																			function(error){
																				window.alert("Error occurred in insert");
																			});
																			
																		});
															
																	});
											
																},
																error: function(e, errorReason){
																	//console.log(e.message);
																	if(errorReason != "abort"){
																		notify('لم يتم التحميل بنجاح! تفحص وسائل الإتصال', 'error', 4000, 'bottom', 'Up', 'Down');
																	}
																	
																	getMagInveRequestObj = "";
																}
															});
															
														}else{//توجد في قاعدة بيانات البرنامج المعلومات لكن يجب تجيك هل توجد ضمنها اخر المعلومات المدرجه في السيرفر
											
															$("#magInveCon" +tapedMagID).html("");
															var i = 0;
															while(result.rows.item(i)){
																$("#magInveCon" +tapedMagID).append('<tr> \
																	<td><a href="#">' +result.rows.item(i).inve_title +'</a></td> \
																	<td><a href="#">' +result.rows.item(i).inve_author +'</a></td> \
																	<td><a href="#" onclick="openUrl(\'http://istighrab.iicss.iq/files/investigations/' +result.rows.item(i).inve_file_path +'\', \'system\');return false;"><i class="fa fa-download" aria-hidden="true"></i></a></td> \
																</tr>');
																i++;
															}
															
														}
											
													},
													function(error){
														window.alert("Error occurred in select");
													}
												);

												transaction.executeSql(
													"SELECT text FROM istighrab_mag_text WHERE mag_id = ?",
													[tapedMagID],
													function(tx, result){
														
														if(result.rows.length < 1/* && result.rows.item(0).text != ""*/){//لا توجد في قاعدة بيانات البرنامج اي معلومه
											
															getMagTextRequestObj = $.ajax({
																type : 'get',
																url : "http://istighrab.iicss.iq/app/json_istighrab_mag_text.php?mag_id=" +tapedMagID,
																async : false,
																jsonpCallback : "istighrabMagTextCallBack",
																contentType : "application/json",
																dataType : 'jsonp',
																success : function(json){
											
																	myDB.transaction(function(transaction){
											
																		transaction.executeSql("INSERT INTO istighrab_mag_text (mag_id, text) VALUES (?, ?)", [tapedMagID, addslashes(json['text'])],
																		function(tx, result) {
																			//window.alert("Inserted");
											
																			$("#magTextCon" +tapedMagID).html(json['text']);
											
																		},
																		function(error){
																			window.alert("Error occurred in insert");
																		});
																		
																	});
															
																},
																error: function(e, errorReason){
																	//console.log(e.message);
																	if(errorReason != "abort"){
																		notify('لم يتم التحميل بنجاح! تفحص وسائل الإتصال', 'error', 4000, 'bottom', 'Up', 'Down');
																	}
																	
																	getMagTextRequestObj = "";
																}
															});
															
														}else{//توجد في قاعدة بيانات البرنامج المعلومات لكن يجب تجيك هل توجد ضمنها اخر المعلومات المدرجه في السيرفر
											
															$("#magTextCon" +tapedMagID).html(stripslashes(result.rows.item(0).text) );
															
														}
											
													},
													function(error){
														window.alert("Error occurred in select");
													}
												);

											});
	
										});
										
									}
									
								},
								function(error){
									window.alert("Error occurred in insert");
								});
								
							});
				
						});

					},
					error: function(e, errorReason){
						//console.log(e.message);
						if(errorReason != "abort"){
							notify('لم يتم التحميل بنجاح! تفحص وسائل الإتصال', 'error', 4000, 'bottom', 'Up', 'Down');
						}
						
						getMagRequestObj = "";
					}
				});
				
			}else{//توجد في قاعدة بيانات البرنامج المعلومات لكن يجب تجيك هل توجد ضمنها اخر المعلومات المدرجه في السيرفر

				var i = 0;
				while(result.rows.item(i)){
					$("#magListCon").attr("lastMagInListSortNum", result.rows.item(i).sort);
					if(i < 1){$("#magListCon").attr("firstMagInListSortNum", result.rows.item(i).sort)}
					$("#magListCon").append('<div class="mag_item" magID="' +result.rows.item(i).id +'"> \
						<div class="mag_item_in"> \
							<div class="mag-name"> \
								<img class="mag-name-logo" src="img/mag-list-logo.png" /> \
								<div class="mag-name-num">' +magNumArray[result.rows.item(i).name] +'</div> \
							</div> \
							<div class="mag-title-middle-holder">&nbsp;</div> \
							<div class="mag-title"> \
							' +((result.rows.item(i).mag_num_title != null)? "--ملف العدد : " +result.rows.item(i).mag_num_title :  "&nbsp;") +' \
							</div> \
							<a class="mag-download fa fa-cloud-download" aria-hidden="true" href="#" onclick="openUrl(\'http://istighrab.iicss.iq/' +result.rows.item(i).pdf_path +'\', \'system\');return false;"></a> \
							<div class="mag-details-up-arrow under"></div><div class="mag-details-up-arrow"></div> \
						</div> \
						<div class="mag-details"> \
							<div class="mag-details-top-button"> \
								<a href="#"><i class="fa fa-align-right" aria-hidden="true"></i> <span>تفاصيل العدد</span></a> \
								<a href="#"><i class="fa fa-pencil-square-o" aria-hidden="true"></i> <span>ابحاث العدد</span></a> \
							</div> \
							<div class="mag-taqarir" style="display:none"> \
 \
								<table class="HHH-table"> \
									<thead> \
										<tr> \
											<th>عنوان البحث</th> \
											<th>الباحث</th> \
											<th>تحمیل</th> \
										</tr> \
									</thead> \
									<tbody id="magInveCon' +result.rows.item(i).id +'"></tbody> \
								</table> \
 \
							</div> \
							<div class="mag-info"> \
 \
								<div class="mag-info-win"> \
									<div class="mag-info-win-title">معلومات العدد</div> \
									<div class="mag-info-win-text" id="magTextCon' +result.rows.item(i).id +'"></div> \
								</div> \
 \
							</div> \
						</div> \
					</div>');
					i++;

					if(i == result.rows.length){
					
						$(".istighrab_mag_list .nano").nanoScroller();
						
						$(".magInfoButton").unbind("tap");
						$(".magInfoButton").bind("tap",function(){
							$(this).parent().siblings("div.mag-info").slideDown();
							$(this).parent().siblings("div.mag-taqarir").slideUp();
							return false;
						});
						
						$(".magInveButton").unbind("tap");
						$(".magInveButton").bind("tap",function(){
							$(this).parent().siblings("div.mag-taqarir").slideDown();
							$(this).parent().siblings("div.mag-info").slideUp();
							return false;
						});
						
						$(".mag_item_in").unbind("tap");
						$(".mag_item_in").bind("tap",function(){

							//window.alert("ok2");
							
							var tapedMag = $(this).parent();
							var tapedMagID = tapedMag.attr("magID");

							var isMagOpened = tapedMag.hasClass("mag-opened");
							$(".mag_item_in").parent().removeClass("mag-opened");
							if(!isMagOpened){
								tapedMag.addClass("mag-opened");
							}else{
								return false;
							}

							/////////////////////////////////////we are here
							myDB.transaction(function(transaction){
								
								transaction.executeSql(
									"SELECT id, inve_title, inve_author, inve_file_path FROM istighrab_mag_investigations WHERE mag_id = ? ORDER BY id ASC",
									[tapedMagID],
									function(tx, result){
										
										if(result.rows.length < 1){//لا توجد في قاعدة بيانات البرنامج اي معلومه
							
											getMagInveRequestObj = $.ajax({
												type : 'get',
												url : "http://istighrab.iicss.iq/app/json_istighrab_mag_inve_items.php?mag_id=" +tapedMagID,
												async : false,
												jsonpCallback : "istighrabMagInveCallBack",
												contentType : "application/json",
												dataType : 'jsonp',
												success : function(json){
							
													$.each(json, function(key, val){
											
														myDB.transaction(function(transaction){
							
															transaction.executeSql("INSERT INTO istighrab_mag_investigations (id, mag_id, inve_title, inve_author, inve_file_path) VALUES (?, ?, ?, ?, ?)", [val['id'], tapedMagID, val['inve_title'], val['inve_author'], val['inve_file_path']],
															function(tx, result) {
																//window.alert("Inserted");
							
																$("#magInveCon" +tapedMagID).append('<tr> \
																	<td><a href="#">' +val['inve_title'] +'</a></td> \
																	<td><a href="#">' +val['inve_author'] +'</a></td> \
																	<td><a href="#" onclick="openUrl(\'http://istighrab.iicss.iq/files/investigations/' +val['inve_file_path'] +'\', \'system\');return false;"><i class="fa fa-download" aria-hidden="true"></i></a></td> \
																</tr>');
																
															},
															function(error){
																window.alert("Error occurred in insert");
															});
															
														});
											
													});
							
												},
												error: function(e, errorReason){
													//console.log(e.message);
													if(errorReason != "abort"){
														notify('لم يتم التحميل بنجاح! تفحص وسائل الإتصال', 'error', 4000, 'bottom', 'Up', 'Down');
													}
													
													getMagInveRequestObj = "";
												}
											});
											
										}else{//توجد في قاعدة بيانات البرنامج المعلومات لكن يجب تجيك هل توجد ضمنها اخر المعلومات المدرجه في السيرفر
							
											$("#magInveCon" +tapedMagID).html("");
											var i = 0;
											while(result.rows.item(i)){
												$("#magInveCon" +tapedMagID).append('<tr> \
													<td><a href="#">' +result.rows.item(i).inve_title +'</a></td> \
													<td><a href="#">' +result.rows.item(i).inve_author +'</a></td> \
													<td><a href="#" onclick="openUrl(\'http://istighrab.iicss.iq/files/investigations/' +result.rows.item(i).inve_file_path +'\', \'system\');return false;"><i class="fa fa-download" aria-hidden="true"></i></a></td> \
												</tr>');
												i++;
											}
											
										}
							
									},
									function(error){
										window.alert("Error occurred in select");
									}
								);

								transaction.executeSql(
									"SELECT text FROM istighrab_mag_text WHERE mag_id = ?",
									[tapedMagID],
									function(tx, result){
										
										if(result.rows.length < 1/* && result.rows.item(0).text != ""*/){//لا توجد في قاعدة بيانات البرنامج اي معلومه
							
											getMagTextRequestObj = $.ajax({
												type : 'get',
												url : "http://istighrab.iicss.iq/app/json_istighrab_mag_text.php?mag_id=" +tapedMagID,
												async : false,
												jsonpCallback : "istighrabMagTextCallBack",
												contentType : "application/json",
												dataType : 'jsonp',
												success : function(json){
							
													myDB.transaction(function(transaction){
							
														transaction.executeSql("INSERT INTO istighrab_mag_text (mag_id, text) VALUES (?, ?)", [tapedMagID, addslashes(json['text'])],
														function(tx, result) {
															//window.alert("Inserted");
							
															$("#magTextCon" +tapedMagID).html(json['text']);
							
														},
														function(error){
															window.alert("Error occurred in insert");
														});
														
													});
											
												},
												error: function(e, errorReason){
													//console.log(e.message);
													if(errorReason != "abort"){
														notify('لم يتم التحميل بنجاح! تفحص وسائل الإتصال', 'error', 4000, 'bottom', 'Up', 'Down');
													}
													
													getMagTextRequestObj = "";
												}
											});
											
										}else{//توجد في قاعدة بيانات البرنامج المعلومات لكن يجب تجيك هل توجد ضمنها اخر المعلومات المدرجه في السيرفر
							
											$("#magTextCon" +tapedMagID).html(stripslashes(result.rows.item(0).text) );
											
										}
							
									},
									function(error){
										window.alert("Error occurred in select");
									}
								);

							});

						});
						
					}
	
	
	
	
	
	
	
	
	
	
					
					
					
					
					
					
				}
				

				//تسلك من السيرفر آخر 15 عنصر الاكبر من اخر عنصر محمل في القائمة
				//فاذا كان عدد العناصر في الريسبوند اقل من 15 يدرجها ضمن القائمة ويضيفها الى قاعدة بيانات السيرفر
				//اما اذا كانت اكثر من 14 يفرغ قاعدة البيانات ويفرغ القائمة ويدرج الـ 15 عنصر المسلكه في قاعدة البيانات وفي القائمة
				getMagRequestObj = $.ajax({
					type : 'get',
					url : "http://istighrab.iicss.iq/app/json_istighrab_mag.php?first_item=" +$("#magListCon").attr("firstMagInListSortNum") +"&item_num=15",
					async : false,
					jsonpCallback : "istighrabMagCallBack",
					contentType : "application/json",
					dataType : 'jsonp',
					success : function(json){
						//window.alert("length is : " +json.length);

						if(json.length < 15){
							//اضفهن الى القاعدة والقائمة

							$.each(json.reverse(), function(key, val){
					
								myDB.transaction(function(transaction){
	
									transaction.executeSql("INSERT INTO istighrab_mag (id, sort, name, protected, pdf_path, mag_num_title) VALUES (?, ?, ?, ?, ?, ?)", [val['id'], val['sort'], val['name'], val['protected'], val['pdf_path'], val['mag_num_title'] ],
									function(tx, result) {
										//window.alert("Inserted");
	
										$("#magListCon").attr("firstMagInListSortNum", val['sort']);
										$("#magListCon").prepend('<div class="mag_item" magID="' +val['id'] +'"> \
											<div class="mag_item_in"> \
												<div class="mag-name"> \
													<img class="mag-name-logo" src="img/mag-list-logo.png" /> \
													<div class="mag-name-num">' +magNumArray[val['name']] +'</div> \
												</div> \
												<div class="mag-title-middle-holder">&nbsp;</div> \
												<div class="mag-title"> \
												' +((val['mag_num_title'] != null)? "ملف العدد : " +val['mag_num_title'] :  "&nbsp;") +' \
												</div> \
												<a class="mag-download fa fa-cloud-download" aria-hidden="true" href="#" onclick="openUrl(\'http://istighrab.iicss.iq/' +val['pdf_path'] +'\', \'system\');return false;"></a> \
												<div class="mag-details-up-arrow under"></div><div class="mag-details-up-arrow"></div> \
											</div> \
											<div class="mag-details"> \
												<div class="mag-details-top-button"> \
													<a href="#"><i class="fa fa-align-right" aria-hidden="true"></i> <span>تفاصيل العدد</span></a> \
													<a href="#"><i class="fa fa-pencil-square-o" aria-hidden="true"></i> <span>ابحاث العدد</span></a> \
												</div> \
												<div class="mag-taqarir" style="display:none"> \
 \
													<table class="HHH-table"> \
														<thead> \
															<tr> \
																<th>عنوان البحث</th> \
																<th>الباحث</th> \
																<th>تحمیل</th> \
															</tr> \
														</thead> \
														<tbody id="magInveCon' +val['id'] +'"></tbody> \
													</table> \
 \
												</div> \
												<div class="mag-info"> \
 \
													<div class="mag-info-win"> \
														<div class="mag-info-win-title">معلومات العدد</div> \
														<div class="mag-info-win-text" id="magTextCon' +val['id'] +'"></div> \
													</div> \
 \
												</div> \
											</div> \
										</div>');

										if((key+1) == json.length){
									
											$(".istighrab_mag_list .nano").nanoScroller();
											
											$(".magInfoButton").unbind("tap");
											$(".magInfoButton").bind("tap",function(){
												$(this).parent().siblings("div.mag-info").slideDown();
												$(this).parent().siblings("div.mag-taqarir").slideUp();
												return false;
											});
											
											$(".magInveButton").unbind("tap");
											$(".magInveButton").bind("tap",function(){
												$(this).parent().siblings("div.mag-taqarir").slideDown();
												$(this).parent().siblings("div.mag-info").slideUp();
												return false;
											});
											
											$(".mag_item_in").unbind("tap");
											$(".mag_item_in").bind("tap",function(){

												//window.alert("ok2");
												
												var tapedMag = $(this).parent();
												var tapedMagID = tapedMag.attr("magID");
					
												var isMagOpened = tapedMag.hasClass("mag-opened");
												$(".mag_item_in").parent().removeClass("mag-opened");
												if(!isMagOpened){
													tapedMag.addClass("mag-opened");
												}else{
													return false;
												}

												/////////////////////////////////////we are here
												myDB.transaction(function(transaction){
													
													transaction.executeSql(
														"SELECT id, inve_title, inve_author, inve_file_path FROM istighrab_mag_investigations WHERE mag_id = ? ORDER BY id ASC",
														[tapedMagID],
														function(tx, result){
															
															if(result.rows.length < 1){//لا توجد في قاعدة بيانات البرنامج اي معلومه
												
																getMagInveRequestObj = $.ajax({
																	type : 'get',
																	url : "http://istighrab.iicss.iq/app/json_istighrab_mag_inve_items.php?mag_id=" +tapedMagID,
																	async : false,
																	jsonpCallback : "istighrabMagInveCallBack",
																	contentType : "application/json",
																	dataType : 'jsonp',
																	success : function(json){
												
																		$.each(json, function(key, val){
																
																			myDB.transaction(function(transaction){
												
																				transaction.executeSql("INSERT INTO istighrab_mag_investigations (id, mag_id, inve_title, inve_author, inve_file_path) VALUES (?, ?, ?, ?, ?)", [val['id'], tapedMagID, val['inve_title'], val['inve_author'], val['inve_file_path']],
																				function(tx, result) {
																					//window.alert("Inserted");
												
																					$("#magInveCon" +tapedMagID).append('<tr> \
																						<td><a href="#">' +val['inve_title'] +'</a></td> \
																						<td><a href="#">' +val['inve_author'] +'</a></td> \
																						<td><a href="#" onclick="openUrl(\'http://istighrab.iicss.iq/files/investigations/' +val['inve_file_path'] +'\', \'system\');return false;"><i class="fa fa-download" aria-hidden="true"></i></a></td> \
																					</tr>');
																					
																				},
																				function(error){
																					window.alert("Error occurred in insert");
																				});
																				
																			});
																
																		});
												
																	},
																	error: function(e, errorReason){
																		//console.log(e.message);
																		if(errorReason != "abort"){
																			notify('لم يتم التحميل بنجاح! تفحص وسائل الإتصال', 'error', 4000, 'bottom', 'Up', 'Down');
																		}
																		
																		getMagInveRequestObj = "";
																	}
																});
																
															}else{//توجد في قاعدة بيانات البرنامج المعلومات لكن يجب تجيك هل توجد ضمنها اخر المعلومات المدرجه في السيرفر
												
																$("#magInveCon" +tapedMagID).html("");
																var i = 0;
																while(result.rows.item(i)){
																	$("#magInveCon" +tapedMagID).append('<tr> \
																		<td><a href="#">' +result.rows.item(i).inve_title +'</a></td> \
																		<td><a href="#">' +result.rows.item(i).inve_author +'</a></td> \
																		<td><a href="#" onclick="openUrl(\'http://istighrab.iicss.iq/files/investigations/' +result.rows.item(i).inve_file_path +'\', \'system\');return false;"><i class="fa fa-download" aria-hidden="true"></i></a></td> \
																	</tr>');
																	i++;
																}
																
															}
												
														},
														function(error){
															window.alert("Error occurred in select");
														}
													);
	
													transaction.executeSql(
														"SELECT text FROM istighrab_mag_text WHERE mag_id = ?",
														[tapedMagID],
														function(tx, result){
															
															if(result.rows.length < 1/* && result.rows.item(0).text != ""*/){//لا توجد في قاعدة بيانات البرنامج اي معلومه
												
																getMagTextRequestObj = $.ajax({
																	type : 'get',
																	url : "http://istighrab.iicss.iq/app/json_istighrab_mag_text.php?mag_id=" +tapedMagID,
																	async : false,
																	jsonpCallback : "istighrabMagTextCallBack",
																	contentType : "application/json",
																	dataType : 'jsonp',
																	success : function(json){
												
																		myDB.transaction(function(transaction){
												
																			transaction.executeSql("INSERT INTO istighrab_mag_text (mag_id, text) VALUES (?, ?)", [tapedMagID, addslashes(json['text'])],
																			function(tx, result) {
																				//window.alert("Inserted");
												
																				$("#magTextCon" +tapedMagID).html(json['text']);
												
																			},
																			function(error){
																				window.alert("Error occurred in insert");
																			});
																			
																		});
																
																	},
																	error: function(e, errorReason){
																		//console.log(e.message);
																		if(errorReason != "abort"){
																			notify('لم يتم التحميل بنجاح! تفحص وسائل الإتصال', 'error', 4000, 'bottom', 'Up', 'Down');
																		}
																		
																		getMagTextRequestObj = "";
																	}
																});
																
															}else{//توجد في قاعدة بيانات البرنامج المعلومات لكن يجب تجيك هل توجد ضمنها اخر المعلومات المدرجه في السيرفر
												
																$("#magTextCon" +tapedMagID).html(stripslashes(result.rows.item(0).text) );
																
															}
												
														},
														function(error){
															window.alert("Error occurred in select");
														}
													);
	
												});

											});
											
										}

									},
									function(error){
										window.alert("Error occurred in insert");
									});
									
								});
					
							});
							

						}else{
							//امسح القاعدة القديمة والقائمة ايضا
							//ثم اضف الـ 15 عنصر الى القاعدة والقائمة

							myDB.transaction(function(transaction){

								transaction.executeSql("DELETE FROM istighrab_mag", [],
								function(tx, result) {
									//window.alert("Inserted");

									$("#magListCon").attr("firstMagInListSortNum", "0");
									$("#magListCon").attr("lastMagInListSortNum", "0");
									$("#magListCon").html("");

									$.each(json, function(key, val){
							
										myDB.transaction(function(transaction){
			
											transaction.executeSql("INSERT INTO istighrab_mag (id, sort, name, protected, pdf_path, mag_num_title) VALUES (?, ?, ?, ?, ?, ?)", [val['id'], val['sort'], val['name'], val['protected'], val['pdf_path'], val['mag_num_title'] ],
											function(tx, result) {
												//window.alert("Inserted");
			
												$("#magListCon").attr("lastMagInListSortNum", val['sort']);
												if(key < 1){$("#magListCon").attr("firstMagInListSortNum", val['sort'])}
												$("#magListCon").append('<div class="mag_item" magID="' +val['id'] +'"> \
													<div class="mag_item_in"> \
														<div class="mag-name"> \
															<img class="mag-name-logo" src="img/mag-list-logo.png" /> \
															<div class="mag-name-num">' +magNumArray[val['name']] +'</div> \
														</div> \
														<div class="mag-title-middle-holder">&nbsp;</div> \
														<div class="mag-title"> \
														' +((val['mag_num_title'] != null)? "ملف العدد : " +val['mag_num_title'] :  "&nbsp;") +' \
														</div> \
														<a class="mag-download fa fa-cloud-download" aria-hidden="true" href="#" onclick="openUrl(\'http://istighrab.iicss.iq/' +val['pdf_path'] +'\', \'system\');return false;"></a> \
														<div class="mag-details-up-arrow under"></div><div class="mag-details-up-arrow"></div> \
													</div> \
													<div class="mag-details"> \
														<div class="mag-details-top-button"> \
															<a href="#"><i class="fa fa-align-right" aria-hidden="true"></i> <span>تفاصيل العدد</span></a> \
															<a href="#"><i class="fa fa-pencil-square-o" aria-hidden="true"></i> <span>ابحاث العدد</span></a> \
														</div> \
														<div class="mag-taqarir" style="display:none"> \
 \
															<table class="HHH-table"> \
																<thead> \
																	<tr> \
																		<th>عنوان البحث</th> \
																		<th>الباحث</th> \
																		<th>تحمیل</th> \
																	</tr> \
																</thead> \
																<tbody id="magInveCon' +val['id'] +'"></tbody> \
															</table> \
 \
														</div> \
														<div class="mag-info"> \
 \
															<div class="mag-info-win"> \
																<div class="mag-info-win-title">معلومات العدد</div> \
																<div class="mag-info-win-text" id="magTextCon' +val['id'] +'"></div> \
															</div> \
 \
														</div> \
													</div> \
												</div>');

												if((key+1) == json.length){
											
													$(".istighrab_mag_list .nano").nanoScroller();
													
													$(".magInfoButton").unbind("tap");
													$(".magInfoButton").bind("tap",function(){
														$(this).parent().siblings("div.mag-info").slideDown();
														$(this).parent().siblings("div.mag-taqarir").slideUp();
														return false;
													});
													
													$(".magInveButton").unbind("tap");
													$(".magInveButton").bind("tap",function(){
														$(this).parent().siblings("div.mag-taqarir").slideDown();
														$(this).parent().siblings("div.mag-info").slideUp();
														return false;
													});
													
													$(".mag_item_in").unbind("tap");
													$(".mag_item_in").bind("tap",function(){

														//window.alert("ok2");
														
														var tapedMag = $(this).parent();
														var tapedMagID = tapedMag.attr("magID");
							
														var isMagOpened = tapedMag.hasClass("mag-opened");
														$(".mag_item_in").parent().removeClass("mag-opened");
														if(!isMagOpened){
															tapedMag.addClass("mag-opened");
														}else{
															return false;
														}

														/////////////////////////////////////we are here
														myDB.transaction(function(transaction){
															
															transaction.executeSql(
																"SELECT id, inve_title, inve_author, inve_file_path FROM istighrab_mag_investigations WHERE mag_id = ? ORDER BY id ASC",
																[tapedMagID],
																function(tx, result){
																	
																	if(result.rows.length < 1){//لا توجد في قاعدة بيانات البرنامج اي معلومه
														
																		getMagInveRequestObj = $.ajax({
																			type : 'get',
																			url : "http://istighrab.iicss.iq/app/json_istighrab_mag_inve_items.php?mag_id=" +tapedMagID,
																			async : false,
																			jsonpCallback : "istighrabMagInveCallBack",
																			contentType : "application/json",
																			dataType : 'jsonp',
																			success : function(json){
														
																				$.each(json, function(key, val){
																		
																					myDB.transaction(function(transaction){
														
																						transaction.executeSql("INSERT INTO istighrab_mag_investigations (id, mag_id, inve_title, inve_author, inve_file_path) VALUES (?, ?, ?, ?, ?)", [val['id'], tapedMagID, val['inve_title'], val['inve_author'], val['inve_file_path']],
																						function(tx, result) {
																							//window.alert("Inserted");
														
																							$("#magInveCon" +tapedMagID).append('<tr> \
																								<td><a href="#">' +val['inve_title'] +'</a></td> \
																								<td><a href="#">' +val['inve_author'] +'</a></td> \
																								<td><a href="#" onclick="openUrl(\'http://istighrab.iicss.iq/files/investigations/' +val['inve_file_path'] +'\', \'system\');return false;"><i class="fa fa-download" aria-hidden="true"></i></a></td> \
																							</tr>');
																							
																						},
																						function(error){
																							window.alert("Error occurred in insert");
																						});
																						
																					});
																		
																				});
														
																			},
																			error: function(e, errorReason){
																				//console.log(e.message);
																				if(errorReason != "abort"){
																					notify('لم يتم التحميل بنجاح! تفحص وسائل الإتصال', 'error', 4000, 'bottom', 'Up', 'Down');
																				}
																				
																				getMagInveRequestObj = "";
																			}
																		});
																		
																	}else{//توجد في قاعدة بيانات البرنامج المعلومات لكن يجب تجيك هل توجد ضمنها اخر المعلومات المدرجه في السيرفر
														
																		$("#magInveCon" +tapedMagID).html("");
																		var i = 0;
																		while(result.rows.item(i)){
																			$("#magInveCon" +tapedMagID).append('<tr> \
																				<td><a href="#">' +result.rows.item(i).inve_title +'</a></td> \
																				<td><a href="#">' +result.rows.item(i).inve_author +'</a></td> \
																				<td><a href="#" onclick="openUrl(\'http://istighrab.iicss.iq/files/investigations/' +result.rows.item(i).inve_file_path +'\', \'system\');return false;"><i class="fa fa-download" aria-hidden="true"></i></a></td> \
																			</tr>');
																			i++;
																		}
																		
																	}
														
																},
																function(error){
																	window.alert("Error occurred in select");
																}
															);
			
															transaction.executeSql(
																"SELECT text FROM istighrab_mag_text WHERE mag_id = ?",
																[tapedMagID],
																function(tx, result){
																	
																	if(result.rows.length < 1/* && result.rows.item(0).text != ""*/){//لا توجد في قاعدة بيانات البرنامج اي معلومه
														
																		getMagTextRequestObj = $.ajax({
																			type : 'get',
																			url : "http://istighrab.iicss.iq/app/json_istighrab_mag_text.php?mag_id=" +tapedMagID,
																			async : false,
																			jsonpCallback : "istighrabMagTextCallBack",
																			contentType : "application/json",
																			dataType : 'jsonp',
																			success : function(json){
														
																				myDB.transaction(function(transaction){
														
																					transaction.executeSql("INSERT INTO istighrab_mag_text (mag_id, text) VALUES (?, ?)", [tapedMagID, addslashes(json['text'])],
																					function(tx, result) {
																						//window.alert("Inserted");
														
																						$("#magTextCon" +tapedMagID).html(json['text']);
														
																					},
																					function(error){
																						window.alert("Error occurred in insert");
																					});
																					
																				});
																		
																			},
																			error: function(e, errorReason){
																				//console.log(e.message);
																				if(errorReason != "abort"){
																					notify('لم يتم التحميل بنجاح! تفحص وسائل الإتصال', 'error', 4000, 'bottom', 'Up', 'Down');
																				}
																				
																				getMagTextRequestObj = "";
																			}
																		});
																		
																	}else{//توجد في قاعدة بيانات البرنامج المعلومات لكن يجب تجيك هل توجد ضمنها اخر المعلومات المدرجه في السيرفر
														
																		$("#magTextCon" +tapedMagID).html(stripslashes(result.rows.item(0).text) );
																		
																	}
														
																},
																function(error){
																	window.alert("Error occurred in select");
																}
															);
			
														});

													});
													
		
												}

											},
											function(error){
												window.alert("Error occurred in insert");
											});
											
										});
							
										i++;
									});
									
									$(".istighrab_mag_list .nano").nanoScroller();

								},
								function(error){
									window.alert("Error occurred in insert");
								});
								
							});
	
						}

					},
					error: function(e, errorReason){
						//console.log(e.message);
						if(errorReason != "abort"){
							notify('لم يتم التحميل بنجاح! تفحص وسائل الإتصال', 'error', 4000, 'bottom', 'Up', 'Down');
						}
						
						getMagRequestObj = "";
					}
				});

			}

		},
		function(error){
			window.alert("Error occurred in select");
		}
	);

});



//الكود الخاص بتحميل المجلات الاقدم
$(".istighrab_mag_list .nano").bind("scrollend", function(e){

	//window.alert("scrollend");
	
	myDB.transaction(function(transaction){
		
		var limit = 6;
		transaction.executeSql(
			"SELECT id, sort, name, protected, pdf_path, mag_num_title FROM istighrab_mag WHERE sort < ? ORDER BY sort DESC, id DESC LIMIT ?",
			[$("#magListCon").attr("lastMagInListSortNum"), limit],
			function(tx, result){
				
				if(result.rows.length < 1){//لا توجد في قاعدة بيانات البرنامج المعلومات المراده
					
					getMagRequestObj = $.ajax({
						type : 'get',
						url : "http://istighrab.iicss.iq/app/json_istighrab_mag.php?last_item=" +$("#magListCon").attr("lastMagInListSortNum") +"&item_num=6",
						async : false,
						jsonpCallback : "istighrabMagCallBack",
						contentType : "application/json",
						dataType : 'jsonp',
						success : function(json){
						
							$.each(json, function(key, val){
					
								myDB.transaction(function(transaction){
	
									transaction.executeSql("INSERT INTO istighrab_mag (id, sort, name, protected, pdf_path, mag_num_title) VALUES (?, ?, ?, ?, ?, ?)", [val['id'], val['sort'], val['name'], val['protected'], val['pdf_path'], val['mag_num_title'] ],
									function(tx, result) {
										//window.alert("Inserted");

										$("#magListCon").attr("lastMagInListSortNum", val['sort']);
										$("#magListCon").append('<div class="mag_item" magID="' +val['id'] +'"> \
											<div class="mag_item_in"> \
												<div class="mag-name"> \
													<img class="mag-name-logo" src="img/mag-list-logo.png" /> \
													<div class="mag-name-num">' +magNumArray[val['name']] +'</div> \
												</div> \
												<div class="mag-title-middle-holder">&nbsp;</div> \
												<div class="mag-title"> \
												' +((val['mag_num_title'] != null)? "ملف العدد : " +val['mag_num_title'] :  "&nbsp;") +' \
												</div> \
												<a class="mag-download fa fa-cloud-download" aria-hidden="true" href="#" onclick="openUrl(\'http://istighrab.iicss.iq/' +val['pdf_path'] +'\', \'system\');return false;"></a> \
												<div class="mag-details-up-arrow under"></div><div class="mag-details-up-arrow"></div> \
											</div> \
											<div class="mag-details"> \
												<div class="mag-details-top-button"> \
													<a href="#"><i class="fa fa-align-right" aria-hidden="true"></i> <span>تفاصيل العدد</span></a> \
													<a href="#"><i class="fa fa-pencil-square-o" aria-hidden="true"></i> <span>ابحاث العدد</span></a> \
												</div> \
												<div class="mag-taqarir" style="display:none"> \
 \
													<table class="HHH-table"> \
														<thead> \
															<tr> \
																<th>عنوان البحث</th> \
																<th>الباحث</th> \
																<th>تحمیل</th> \
															</tr> \
														</thead> \
														<tbody id="magInveCon' +val['id'] +'"></tbody> \
													</table> \
 \
												</div> \
												<div class="mag-info"> \
 \
													<div class="mag-info-win"> \
														<div class="mag-info-win-title">معلومات العدد</div> \
														<div class="mag-info-win-text" id="magTextCon' +val['id'] +'"></div> \
													</div> \
 \
												</div> \
											</div> \
										</div>');

										if((key+1) == json.length){
									
											$(".istighrab_mag_list .nano").nanoScroller();
											
											$(".magInfoButton").unbind("tap");
											$(".magInfoButton").bind("tap",function(){
												$(this).parent().siblings("div.mag-info").slideDown();
												$(this).parent().siblings("div.mag-taqarir").slideUp();
												return false;
											});
											
											$(".magInveButton").unbind("tap");
											$(".magInveButton").bind("tap",function(){
												$(this).parent().siblings("div.mag-taqarir").slideDown();
												$(this).parent().siblings("div.mag-info").slideUp();
												return false;
											});
											
											$(".mag_item_in").unbind("tap");
											$(".mag_item_in").bind("tap",function(){
												//mag-opened
												
												
												
												//window.alert("ok2");
												
												var tapedMag = $(this).parent();
												var tapedMagID = tapedMag.attr("magID");
					
												var isMagOpened = tapedMag.hasClass("mag-opened");
												$(".mag_item_in").parent().removeClass("mag-opened");
												if(!isMagOpened){
													tapedMag.addClass("mag-opened");
												}else{
													return false;
												}

												/////////////////////////////////////we are here
												myDB.transaction(function(transaction){
													
													transaction.executeSql(
														"SELECT id, inve_title, inve_author, inve_file_path FROM istighrab_mag_investigations WHERE mag_id = ? ORDER BY id ASC",
														[tapedMagID],
														function(tx, result){
															
															if(result.rows.length < 1){//لا توجد في قاعدة بيانات البرنامج اي معلومه
												
																getMagInveRequestObj = $.ajax({
																	type : 'get',
																	url : "http://istighrab.iicss.iq/app/json_istighrab_mag_inve_items.php?mag_id=" +tapedMagID,
																	async : false,
																	jsonpCallback : "istighrabMagInveCallBack",
																	contentType : "application/json",
																	dataType : 'jsonp',
																	success : function(json){
												
																		$.each(json, function(key, val){
																
																			myDB.transaction(function(transaction){
												
																				transaction.executeSql("INSERT INTO istighrab_mag_investigations (id, mag_id, inve_title, inve_author, inve_file_path) VALUES (?, ?, ?, ?, ?)", [val['id'], tapedMagID, val['inve_title'], val['inve_author'], val['inve_file_path']],
																				function(tx, result) {
																					//window.alert("Inserted");
												
																					$("#magInveCon" +tapedMagID).append('<tr> \
																						<td><a href="#">' +val['inve_title'] +'</a></td> \
																						<td><a href="#">' +val['inve_author'] +'</a></td> \
																						<td><a href="#" onclick="openUrl(\'http://istighrab.iicss.iq/files/investigations/' +val['inve_file_path'] +'\', \'system\');return false;"><i class="fa fa-download" aria-hidden="true"></i></a></td> \
																					</tr>');
																					
																				},
																				function(error){
																					window.alert("Error occurred in insert");
																				});
																				
																			});
																
																		});
												
																	},
																	error: function(e, errorReason){
																		//console.log(e.message);
																		if(errorReason != "abort"){
																			notify('لم يتم التحميل بنجاح! تفحص وسائل الإتصال', 'error', 4000, 'bottom', 'Up', 'Down');
																		}
																		
																		getMagInveRequestObj = "";
																	}
																});
																
															}else{//توجد في قاعدة بيانات البرنامج المعلومات لكن يجب تجيك هل توجد ضمنها اخر المعلومات المدرجه في السيرفر
												
																$("#magInveCon" +tapedMagID).html("");
																var i = 0;
																while(result.rows.item(i)){
																	$("#magInveCon" +tapedMagID).append('<tr> \
																		<td><a href="#">' +result.rows.item(i).inve_title +'</a></td> \
																		<td><a href="#">' +result.rows.item(i).inve_author +'</a></td> \
																		<td><a href="#" onclick="openUrl(\'http://istighrab.iicss.iq/files/investigations/' +result.rows.item(i).inve_file_path +'\', \'system\');return false;"><i class="fa fa-download" aria-hidden="true"></i></a></td> \
																	</tr>');
																	i++;
																}
																
															}
												
														},
														function(error){
															window.alert("Error occurred in select");
														}
													);
	
													transaction.executeSql(
														"SELECT text FROM istighrab_mag_text WHERE mag_id = ?",
														[tapedMagID],
														function(tx, result){
															
															if(result.rows.length < 1/* && result.rows.item(0).text != ""*/){//لا توجد في قاعدة بيانات البرنامج اي معلومه
												
																getMagTextRequestObj = $.ajax({
																	type : 'get',
																	url : "http://istighrab.iicss.iq/app/json_istighrab_mag_text.php?mag_id=" +tapedMagID,
																	async : false,
																	jsonpCallback : "istighrabMagTextCallBack",
																	contentType : "application/json",
																	dataType : 'jsonp',
																	success : function(json){
												
																		myDB.transaction(function(transaction){
												
																			transaction.executeSql("INSERT INTO istighrab_mag_text (mag_id, text) VALUES (?, ?)", [tapedMagID, addslashes(json['text'])],
																			function(tx, result) {
																				//window.alert("Inserted");
												
																				$("#magTextCon" +tapedMagID).html(json['text']);
												
																			},
																			function(error){
																				window.alert("Error occurred in insert");
																			});
																			
																		});
																
																	},
																	error: function(e, errorReason){
																		//console.log(e.message);
																		if(errorReason != "abort"){
																			notify('لم يتم التحميل بنجاح! تفحص وسائل الإتصال', 'error', 4000, 'bottom', 'Up', 'Down');
																		}
																		
																		getMagTextRequestObj = "";
																	}
																});
																
															}else{//توجد في قاعدة بيانات البرنامج المعلومات لكن يجب تجيك هل توجد ضمنها اخر المعلومات المدرجه في السيرفر
												
																$("#magTextCon" +tapedMagID).html(stripslashes(result.rows.item(0).text) );
																
															}
												
														},
														function(error){
															window.alert("Error occurred in select");
														}
													);
	
												});

											});
											
										}

									},
									function(error){
										window.alert("Error occurred in insert");
									});
									
								});
					
							});
							
					
								
						},
						error: function(e, errorReason){
							//console.log(e.message);
							if(errorReason != "abort"){
								notify('لم يتم التحميل بنجاح! تفحص وسائل الإتصال', 'error', 4000, 'bottom', 'Up', 'Down');
							}
							
							getMagRequestObj = "";
						}
					});
					
				}else{//توجد في قاعدة بيانات البرنامج المعلومات
				
					var i = 0;
					while(result.rows.item(i)){
						$("#magListCon").attr("lastMagInListSortNum", result.rows.item(i).sort);
						$("#magListCon").append('<div class="mag_item" magID="' +result.rows.item(i).id +'"> \
							<div class="mag_item_in"> \
								<div class="mag-name"> \
									<img class="mag-name-logo" src="img/mag-list-logo.png" /> \
									<div class="mag-name-num">' +magNumArray[result.rows.item(i).name] +'</div> \
								</div> \
								<div class="mag-title-middle-holder">&nbsp;</div> \
								<div class="mag-title"> \
								' +((result.rows.item(i).mag_num_title != null)? "--ملف العدد : " +result.rows.item(i).mag_num_title :  "&nbsp;") +' \
								</div> \
								<a class="mag-download fa fa-cloud-download" aria-hidden="true" href="#" onclick="openUrl(\'http://istighrab.iicss.iq/' +result.rows.item(i).pdf_path +'\', \'system\');return false;"></a> \
								<div class="mag-details-up-arrow under"></div><div class="mag-details-up-arrow"></div> \
							</div> \
							<div class="mag-details"> \
								<div class="mag-details-top-button"> \
									<a href="#"><i class="fa fa-align-right" aria-hidden="true"></i> <span>تفاصيل العدد</span></a> \
									<a href="#"><i class="fa fa-pencil-square-o" aria-hidden="true"></i> <span>ابحاث العدد</span></a> \
								</div> \
								<div class="mag-taqarir" style="display:none"> \
 \
									<table class="HHH-table"> \
										<thead> \
											<tr> \
												<th>عنوان البحث</th> \
												<th>الباحث</th> \
												<th>تحمیل</th> \
											</tr> \
										</thead> \
										<tbody id="magInveCon' +result.rows.item(i).id +'"></tbody> \
									</table> \
 \
								</div> \
								<div class="mag-info"> \
 \
									<div class="mag-info-win"> \
										<div class="mag-info-win-title">معلومات العدد</div> \
										<div class="mag-info-win-text" id="magTextCon' +result.rows.item(i).id +'"></div> \
									</div> \
 \
								</div> \
							</div> \
						</div>');
						i++;

						if(i == result.rows.length){
					
							$(".istighrab_mag_list .nano").nanoScroller();
							
							$(".magInfoButton").unbind("tap");
							$(".magInfoButton").bind("tap",function(){
								$(this).parent().siblings("div.mag-info").slideDown();
								$(this).parent().siblings("div.mag-taqarir").slideUp();
								return false;
							});
							
							$(".magInveButton").unbind("tap");
							$(".magInveButton").bind("tap",function(){
								$(this).parent().siblings("div.mag-taqarir").slideDown();
								$(this).parent().siblings("div.mag-info").slideUp();
								return false;
							});
							
							$(".mag_item_in").unbind("tap");
							$(".mag_item_in").bind("tap",function(){
								//mag-opened
								
								
								
								//window.alert("ok2");
								
								var tapedMag = $(this).parent();
								var tapedMagID = tapedMag.attr("magID");
	
								var isMagOpened = tapedMag.hasClass("mag-opened");
								$(".mag_item_in").parent().removeClass("mag-opened");
								if(!isMagOpened){
									tapedMag.addClass("mag-opened");
								}else{
									return false;
								}

								/////////////////////////////////////we are here
								myDB.transaction(function(transaction){
									
									transaction.executeSql(
										"SELECT id, inve_title, inve_author, inve_file_path FROM istighrab_mag_investigations WHERE mag_id = ? ORDER BY id ASC",
										[tapedMagID],
										function(tx, result){
											
											if(result.rows.length < 1){//لا توجد في قاعدة بيانات البرنامج اي معلومه
								
												getMagInveRequestObj = $.ajax({
													type : 'get',
													url : "http://istighrab.iicss.iq/app/json_istighrab_mag_inve_items.php?mag_id=" +tapedMagID,
													async : false,
													jsonpCallback : "istighrabMagInveCallBack",
													contentType : "application/json",
													dataType : 'jsonp',
													success : function(json){
								
														$.each(json, function(key, val){
												
															myDB.transaction(function(transaction){
								
																transaction.executeSql("INSERT INTO istighrab_mag_investigations (id, mag_id, inve_title, inve_author, inve_file_path) VALUES (?, ?, ?, ?, ?)", [val['id'], tapedMagID, val['inve_title'], val['inve_author'], val['inve_file_path']],
																function(tx, result) {
																	//window.alert("Inserted");
								
																	$("#magInveCon" +tapedMagID).append('<tr> \
																		<td><a href="#">' +val['inve_title'] +'</a></td> \
																		<td><a href="#">' +val['inve_author'] +'</a></td> \
																		<td><a href="#" onclick="openUrl(\'http://istighrab.iicss.iq/files/investigations/' +val['inve_file_path'] +'\', \'system\');return false;"><i class="fa fa-download" aria-hidden="true"></i></a></td> \
																	</tr>');
																	
																},
																function(error){
																	window.alert("Error occurred in insert");
																});
																
															});
												
														});
								
													},
													error: function(e, errorReason){
														//console.log(e.message);
														if(errorReason != "abort"){
															notify('لم يتم التحميل بنجاح! تفحص وسائل الإتصال', 'error', 4000, 'bottom', 'Up', 'Down');
														}
														
														getMagInveRequestObj = "";
													}
												});
												
											}else{//توجد في قاعدة بيانات البرنامج المعلومات لكن يجب تجيك هل توجد ضمنها اخر المعلومات المدرجه في السيرفر
								
												$("#magInveCon" +tapedMagID).html("");
												var i = 0;
												while(result.rows.item(i)){
													$("#magInveCon" +tapedMagID).append('<tr> \
														<td><a href="#">' +result.rows.item(i).inve_title +'</a></td> \
														<td><a href="#">' +result.rows.item(i).inve_author +'</a></td> \
														<td><a href="#" onclick="openUrl(\'http://istighrab.iicss.iq/files/investigations/' +result.rows.item(i).inve_file_path +'\', \'system\');return false;"><i class="fa fa-download" aria-hidden="true"></i></a></td> \
													</tr>');
													i++;
												}
												
											}
								
										},
										function(error){
											window.alert("Error occurred in select");
										}
									);

									transaction.executeSql(
										"SELECT text FROM istighrab_mag_text WHERE mag_id = ?",
										[tapedMagID],
										function(tx, result){
											
											if(result.rows.length < 1/* && result.rows.item(0).text != ""*/){//لا توجد في قاعدة بيانات البرنامج اي معلومه
								
												getMagTextRequestObj = $.ajax({
													type : 'get',
													url : "http://istighrab.iicss.iq/app/json_istighrab_mag_text.php?mag_id=" +tapedMagID,
													async : false,
													jsonpCallback : "istighrabMagTextCallBack",
													contentType : "application/json",
													dataType : 'jsonp',
													success : function(json){
								
														myDB.transaction(function(transaction){
								
															transaction.executeSql("INSERT INTO istighrab_mag_text (mag_id, text) VALUES (?, ?)", [tapedMagID, addslashes(json['text'])],
															function(tx, result) {
																//window.alert("Inserted");
								
																$("#magTextCon" +tapedMagID).html(json['text']);
								
															},
															function(error){
																window.alert("Error occurred in insert");
															});
															
														});
												
													},
													error: function(e, errorReason){
														//console.log(e.message);
														if(errorReason != "abort"){
															notify('لم يتم التحميل بنجاح! تفحص وسائل الإتصال', 'error', 4000, 'bottom', 'Up', 'Down');
														}
														
														getMagTextRequestObj = "";
													}
												});
												
											}else{//توجد في قاعدة بيانات البرنامج المعلومات لكن يجب تجيك هل توجد ضمنها اخر المعلومات المدرجه في السيرفر
								
												$("#magTextCon" +tapedMagID).html(stripslashes(result.rows.item(0).text) );
												
											}
								
										},
										function(error){
											window.alert("Error occurred in select");
										}
									);

								});
								
							});
							
						}


					}
					
					
				}

			},
			function(error){
				window.alert("Error occurred in select");
			}
		);

	});

	//window.alert("lastMagInListSortNum : " +$("#magListCon").attr("lastMagInListSortNum") );

});



$(".istighrab_mag_list .nano").bind("scrolltop", function(e){
	//window.alert("top / first item sort num is : " +$("#magListCon").attr("firstMagInListSortNum") );

	getMagRequestObj = $.ajax({
		type : 'get',
		url : "http://istighrab.iicss.iq/app/json_istighrab_mag.php?first_item=" +$("#magListCon").attr("firstMagInListSortNum") +"&item_num=500000",
		async : false,
		jsonpCallback : "istighrabMagCallBack",
		contentType : "application/json",
		dataType : 'jsonp',
		success : function(json){

			$.each(json.reverse(), function(key, val){
	
				myDB.transaction(function(transaction){
	
					transaction.executeSql("INSERT INTO istighrab_mag (id, sort, name, protected, pdf_path, mag_num_title) VALUES (?, ?, ?, ?, ?, ?)", [val['id'], val['sort'], val['name'], val['protected'], val['pdf_path'], val['mag_num_title'] ],
					function(tx, result) {
						//window.alert("Inserted");
	
						$("#magListCon").attr("firstMagInListSortNum", val['sort']);
						$("#magListCon").prepend('<div class="mag_item" magID="' +val['id'] +'"> \
							<div class="mag_item_in"> \
								<div class="mag-name"> \
									<img class="mag-name-logo" src="img/mag-list-logo.png" /> \
									<div class="mag-name-num">' +magNumArray[val['name']] +'</div> \
								</div> \
								<div class="mag-title-middle-holder">&nbsp;</div> \
								<div class="mag-title"> \
								' +((val['mag_num_title'] != null)? "ملف العدد : " +val['mag_num_title'] :  "&nbsp;") +' \
								</div> \
								<a class="mag-download fa fa-cloud-download" aria-hidden="true" href="#" onclick="openUrl(\'http://istighrab.iicss.iq/' +val['pdf_path'] +'\', \'system\');return false;"></a> \
								<div class="mag-details-up-arrow under"></div><div class="mag-details-up-arrow"></div> \
							</div> \
							<div class="mag-details"> \
								<div class="mag-details-top-button"> \
									<a href="#"><i class="fa fa-align-right" aria-hidden="true"></i> <span>تفاصيل العدد</span></a> \
									<a href="#"><i class="fa fa-pencil-square-o" aria-hidden="true"></i> <span>ابحاث العدد</span></a> \
								</div> \
								<div class="mag-taqarir" style="display:none"> \
 \
									<table class="HHH-table"> \
										<thead> \
											<tr> \
												<th>عنوان البحث</th> \
												<th>الباحث</th> \
												<th>تحمیل</th> \
											</tr> \
										</thead> \
										<tbody id="magInveCon' +val['id'] +'"></tbody> \
									</table> \
 \
								</div> \
								<div class="mag-info"> \
 \
									<div class="mag-info-win"> \
										<div class="mag-info-win-title">معلومات العدد</div> \
										<div class="mag-info-win-text" id="magTextCon' +val['id'] +'"></div> \
									</div> \
 \
								</div> \
							</div> \
						</div>');

						if((key+1) == json.length){
					
							$(".istighrab_mag_list .nano").nanoScroller();
							
							$(".magInfoButton").unbind("tap");
							$(".magInfoButton").bind("tap",function(){
								$(this).parent().siblings("div.mag-info").slideDown();
								$(this).parent().siblings("div.mag-taqarir").slideUp();
								return false;
							});
							
							$(".magInveButton").unbind("tap");
							$(".magInveButton").bind("tap",function(){
								$(this).parent().siblings("div.mag-taqarir").slideDown();
								$(this).parent().siblings("div.mag-info").slideUp();
								return false;
							});
							
							$(".mag_item_in").unbind("tap");
							$(".mag_item_in").bind("tap",function(){
								//mag-opened
								
								
								
								//window.alert("ok2");
								
								var tapedMag = $(this).parent();
								var tapedMagID = tapedMag.attr("magID");
	
								var isMagOpened = tapedMag.hasClass("mag-opened");
								$(".mag_item_in").parent().removeClass("mag-opened");
								if(!isMagOpened){
									tapedMag.addClass("mag-opened");
								}else{
									return false;
								}

								/////////////////////////////////////we are here
								myDB.transaction(function(transaction){
									
									transaction.executeSql(
										"SELECT id, inve_title, inve_author, inve_file_path FROM istighrab_mag_investigations WHERE mag_id = ? ORDER BY id ASC",
										[tapedMagID],
										function(tx, result){
											
											if(result.rows.length < 1){//لا توجد في قاعدة بيانات البرنامج اي معلومه
								
												getMagInveRequestObj = $.ajax({
													type : 'get',
													url : "http://istighrab.iicss.iq/app/json_istighrab_mag_inve_items.php?mag_id=" +tapedMagID,
													async : false,
													jsonpCallback : "istighrabMagInveCallBack",
													contentType : "application/json",
													dataType : 'jsonp',
													success : function(json){
								
														$.each(json, function(key, val){
												
															myDB.transaction(function(transaction){
								
																transaction.executeSql("INSERT INTO istighrab_mag_investigations (id, mag_id, inve_title, inve_author, inve_file_path) VALUES (?, ?, ?, ?, ?)", [val['id'], tapedMagID, val['inve_title'], val['inve_author'], val['inve_file_path']],
																function(tx, result) {
																	//window.alert("Inserted");
								
																	$("#magInveCon" +tapedMagID).append('<tr> \
																		<td><a href="#">' +val['inve_title'] +'</a></td> \
																		<td><a href="#">' +val['inve_author'] +'</a></td> \
																		<td><a href="#" onclick="openUrl(\'http://istighrab.iicss.iq/files/investigations/' +val['inve_file_path'] +'\', \'system\');return false;"><i class="fa fa-download" aria-hidden="true"></i></a></td> \
																	</tr>');
																	
																},
																function(error){
																	window.alert("Error occurred in insert");
																});
																
															});
												
														});
								
													},
													error: function(e, errorReason){
														//console.log(e.message);
														if(errorReason != "abort"){
															notify('لم يتم التحميل بنجاح! تفحص وسائل الإتصال', 'error', 4000, 'bottom', 'Up', 'Down');
														}
														
														getMagInveRequestObj = "";
													}
												});
												
											}else{//توجد في قاعدة بيانات البرنامج المعلومات لكن يجب تجيك هل توجد ضمنها اخر المعلومات المدرجه في السيرفر
								
												$("#magInveCon" +tapedMagID).html("");
												var i = 0;
												while(result.rows.item(i)){
													$("#magInveCon" +tapedMagID).append('<tr> \
														<td><a href="#">' +result.rows.item(i).inve_title +'</a></td> \
														<td><a href="#">' +result.rows.item(i).inve_author +'</a></td> \
														<td><a href="#" onclick="openUrl(\'http://istighrab.iicss.iq/files/investigations/' +result.rows.item(i).inve_file_path +'\', \'system\');return false;"><i class="fa fa-download" aria-hidden="true"></i></a></td> \
													</tr>');
													i++;
												}
												
											}
								
										},
										function(error){
											window.alert("Error occurred in select");
										}
									);

									transaction.executeSql(
										"SELECT text FROM istighrab_mag_text WHERE mag_id = ?",
										[tapedMagID],
										function(tx, result){
											
											if(result.rows.length < 1/* && result.rows.item(0).text != ""*/){//لا توجد في قاعدة بيانات البرنامج اي معلومه
								
												getMagTextRequestObj = $.ajax({
													type : 'get',
													url : "http://istighrab.iicss.iq/app/json_istighrab_mag_text.php?mag_id=" +tapedMagID,
													async : false,
													jsonpCallback : "istighrabMagTextCallBack",
													contentType : "application/json",
													dataType : 'jsonp',
													success : function(json){
								
														myDB.transaction(function(transaction){
								
															transaction.executeSql("INSERT INTO istighrab_mag_text (mag_id, text) VALUES (?, ?)", [tapedMagID, addslashes(json['text'])],
															function(tx, result) {
																//window.alert("Inserted");
								
																$("#magTextCon" +tapedMagID).html(json['text']);
								
															},
															function(error){
																window.alert("Error occurred in insert");
															});
															
														});
												
													},
													error: function(e, errorReason){
														//console.log(e.message);
														if(errorReason != "abort"){
															notify('لم يتم التحميل بنجاح! تفحص وسائل الإتصال', 'error', 4000, 'bottom', 'Up', 'Down');
														}
														
														getMagTextRequestObj = "";
													}
												});
												
											}else{//توجد في قاعدة بيانات البرنامج المعلومات لكن يجب تجيك هل توجد ضمنها اخر المعلومات المدرجه في السيرفر
								
												$("#magTextCon" +tapedMagID).html(stripslashes(result.rows.item(0).text) );
												
											}
								
										},
										function(error){
											window.alert("Error occurred in select");
										}
									);

								});
							
							});
							
						}

					},
					function(error){
						window.alert("Error occurred in insert");
					});
					
				});
	
			});
			
			
	
	
	




	
		},
		error: function(e, errorReason){
			//console.log(e.message);
			if(errorReason != "abort"){
				notify('لم يتم التحميل بنجاح! تفحص وسائل الإتصال', 'error', 4000, 'bottom', 'Up', 'Down');
			}
			
			getMagRequestObj = "";
		}
	});

});







$(".istighrab_mag_list .nano").nanoScroller({ alwaysVisible: true });

	
	
	
	

	
	
	
	
	
/*	
	
	
				getMagRequestObj = $.ajax({
					type : 'get',
					url : "http://istighrab.iicss.iq/app/json_istighrab_mag.php",
					async : false,
					jsonpCallback : "istighrabMagCallBack",
					contentType : "application/json",
					dataType : 'jsonp',
					success : function(json){
						//$("#esdarat-item-list_contaner #esdarat-item-list_contaner_in").html("");
					
						$.each(json, function(key, val){
				
							myDB.transaction(function(transaction){
								
								transaction.executeSql("select * from istighrab_mag WHERE id = ?", [val['id']],
								function(tx, result) {
									isRowExisted = result.rows.length;
									window.alert("selected num in is : "+result.rows.length)
								},
								function(error){
									//window.alert("Error occurred in select");
								});
								window.alert("selected num is : "+isRowExisted);
								
								
								if(!isRowExisted){
									transaction.executeSql("INSERT INTO istighrab_mag (id, sort, name, protected, pdf_path, mag_num_title) VALUES (?, ?, ?, ?, ?, ?)", [val['id'], val['sort'], val['name'], val['protected'], val['pdf_path'], val['mag_num_title'] ],
									function(tx, result) {
										window.alert("Inserted");
									},
									function(error){
										window.alert("Error occurred in insert");
									});
								}else{
									transaction.executeSql("UPDATE istighrab_mag SET sort = ?, name = ?, protected = ?, pdf_path = ?, mag_num_title = ? WHERE id = ?", [val['sort'], val['name'], val['protected'], val['pdf_path'], vals['masg_num_title'], val['id']],
									function(tx, result) {
										window.alert("updated");
									},
									function(error){
										window.alert("Error occurred in update");
									});
								}
							});
				
							
						});
						
						
						$(".istighrab_mag_list .nano").nanoScroller({ alwaysVisible: true });
				
							
					},
					error: function(e, errorReason){
						//console.log(e.message);
						if(errorReason != "abort"){
							notify('لم يتم التحميل بنجاح! تفحص وسائل الإتصال', 'error', 4000, 'bottom', 'Up', 'Down');
						}
						TapedElement.siblings(".loading2").remove();
						
						getMagRequestObj = "";
					}
				});




*/



	

	
	
	
	
	}
	
	
	
	
	
	
	
	$(window).bind("hashchange",function(){
        if(window.location.hash == "#main"){
			$('#sis-app-header').slideUp(150);
		}else{
			$('#sis-app-header').slideDown(150);
		}
    });
	
	</script>
	<style>
	/*الإصدارات - esdarat*/
	.white-item{
		background:#fcfdfe;
		border:1px solid #eaeef1;
		margin:8px 0 0 0;
		box-shadow: 0 1px 1px rgba(0, 0, 0, 0.05);
		text-decoration:none;
	}
	.white-item .panel-subject{
		padding:10px;
		text-align:center;
		font-family:hacen_xxl;
		font-size:17px;
		color:#838282;
	}
	div.colored-win{
		border:1px solid #eaeef1;
		border-radius:3px;
		background:#ffffff;
		margin:8px 0 0 0;
		overflow:hidden;
		direction:rtl;
	}
	div.colored-win .c-w-title{
		border-bottom:1px solid #eaeef1;
		background:#1ccacc;
		height:50px;
		line-height:50px;
		text-indent:20px;
		font-size:16px;
		font-family:"hacen_xxl";
		color:#fff;
		
	}
	span.grid-item{
		display:inline-block;
		width:25%;
		vertical-align:top;
	}
	@media screen and (orientation : portrait){
		span.grid-item{
			width:33.3333333333333333%;
		}
	}
	@media screen and (max-width: 14cm) and (orientation : portrait){
		span.grid-item{
			width:50%;
		}
	}
	span.grid-item div.in{
		position:relative;
		border: 1px solid #eaeef1;
		box-shadow: 0 1px 1px rgba(0, 0, 0, 0.05);
		margin:3px;
		padding:3px;
	}
	span.grid-item div.in h3.title{
		border-top:1px solid #eaeef1;
		font-size:13px;
		font-family:"hacen_light";
		font-weight:normal;
		padding:3px 5px 0 5px;
		color:#6d7077;
		max-height:55px;
		overflow:hidden;
		line-height:24px;
	}
	.loading{
		position:absolute;
		top:0;
		bottom:0;
		left:0;
		right:0;
		background:url("img/loading.gif") no-repeat center center #FFF;
	}
	.loading2{
		position:absolute;
		top:0;
		bottom:0;
		left:0;
		right:0;
		background:url("img/loading2.gif") no-repeat center center #FFF;
		background-size:35px;
		opacity:0.4;
	}
	</style>
	<style>
	/*مشاهدة الإصدار - esdarat-inside-content*/
	
	#esdarat-inside-content .esdar-title, #alrasad_marakiz-inside-content .markaz-title, #alrasad_taqarir-inside-content .taqrir-title{
		font-family:"hacen_screen";
		font-size:20px;
		text-align:center;
		line-height:30px;
		padding:8px 0;
		color:#5d6066;
	}
	#esdarat-inside-content #esdar-text img{
		width:150px;
		padding:1px;
		border: 1px solid #eaeef1;
		box-shadow: 0 1px 1px rgba(0, 0, 0, 0.05);
	}
	#esdarat-inside-content #esdar-text a{
		display:block;
		background:#d06975;
		margin:10px 0;
		padding:10px;
		text-decoration:none;
		color:#FFF;
		border-radius:5px;
		font-size:18px;
	}
	.app-text{
		direction:rtl;
		font-family:Droid Arabic Naskh;
		text-align:justify;
		color:#797979;
		line-height:25px;
		padding:5px 10px 0 10px;
	}
	.app-text p{
		line-height:33px;
		color:#3a3c3f;
		font-size:13px;
	}
	.load_more{
		display:block;
		background:#ededed;
		margin:10px 0;
		padding:10px;
		text-decoration:none;
		color:#bebdbd;
		border-radius:5px;
		font-size:17px;
		text-align:center;
		font-family:"hacen_screen";
	}
	/*					@media screen and (min-width: 17cm) and (orientation : portrait){
		.app-text{
			padding:10px 10px 0 10px;
		}
		.app-text p{
			font-size:18px;
			line-height:35px;
		}
	}
	@media screen and (min-width: 20cm){
		.app-text{
			padding:10px 10px 0 10px;
		}
		.app-text p{
			font-size:18px;
			line-height:35px;
		}
	}*/
	
	
	
	span.list-pic-item{
		display:inline-block;
		vertical-align:top;
		background:#fbfbfb;
		position:relative;
		border: 1px solid #eaeef1;
		box-shadow: 0 1px 1px rgba(0, 0, 0, 0.05);
		margin:3px;
		padding:3px;
	}
	span.list-pic-item div.in img{
		float:right;
		border-left: 1px solid #eaeef1;
		padding:1px;
		max-height:100%;
		width:auto;
	}
	span.list-pic-item div.in h3.title{
		font-size:13px;
		font-family:"hacen_light";
		font-weight:normal;
		padding:3px 5px 0 5px;
		color:#6d7077;
		overflow:hidden;
		line-height:24px;
	}
	
	.list-pic_item{
		position:relative;
		display:block;
		background:#fcfdfe;
		border:1px solid #eaeef1;
		margin:8px 0 0 0;
		/*height:84px;*/
		box-shadow: 0 1px 1px rgba(0, 0, 0, 0.05);
		text-decoration:none;
		direction:rtl;
		white-space:nowrap;
		overflow:hidden;
	}
	.list-pic_item .pic-text{
		height:84px;
		overflow:hidden;
	}
	.list-pic_item .pic-text img{
		padding:1px;
		vertical-align:middle;
		position:absolute;
		top:0;
		right:0;
		border-left:1px solid #eaeef1;
	}
	.list-pic_item .pic-text table.text{
		vertical-align:middle;
		width:100%;
		
	}
	.list-pic_item .pic-text table.text td{
		height:78px;
		padding:0 80px 0 8px;
		margin:0;
		white-space:normal;
		font-family:"hacen_xxl";
		font-size:14px;
		color:#6d7077;
		text-align:right;
	}
	.list-pic_item .details{
		border-top:1px solid #eaeef1;
		font-size:15px;
		background:#fdfdfd;
		padding:2px;
		display:none;
	}
	.list-pic_item .details .p-item{
		padding:5px 10px;
	}
	.list-pic_item .details .p-item img{
		vertical-align:middle;
	}
	.list-pic_item .details .p-item span{
		font-family:"hacen_light";
		padding:0 10px 0 0;
		font-size:14px;
		color:#5a5e64;
	}
	.list-pic_item .details .text{
		border-top:1px solid #F5F5F5;
		white-space:normal;
		padding:10px 10px 4px 10px;
		margin:4px 0 0 0;
		font-family:"Droid Arabic Naskh";
		font-size:12px;
		line-height:27px;
		text-align:justify;
		color:#5a5e64;
	}
	.list-pic_item .details .text span.read_more{
		display:block;
		background:#d06975;
		margin:6px 0;
		padding:5px;
		color:#FFF;
		border-radius:5px;
		font-size:16px;
		font-family:"hacen_screen";
		text-align:center;
	}
	.list-pic_item .details .text span.read_more span{
		display:none;
	}
	
	#alrasad_taqarir-inside-content .details{
		background:#fcfdfd;
		margin:3px -10px 13px -10px;
		padding:5px 0;
		border-top:1px solid #f7f8f9;
		border-bottom:1px solid #f7f8f9;
	}
	#alrasad_taqarir-inside-content .details .p-item{
		padding:9px 10px;
	}
	#alrasad_taqarir-inside-content .details .p-item img{
		vertical-align:middle;
	}
	#alrasad_taqarir-inside-content .details .p-item span{
		font-family:"hacen_light";
		padding:0 10px 0 0;
		font-size:15px;
		color:#5a5e64;
	}
	
	.noty_message{
		font-family:"hacen_light" !important;
		padding:13px 15px 13px 15px !important;
	}
	</style>
</head>

<body onload="init()">
<div id="afui" class="hassan">
<!--    <div id="splashscreen" class='ui-loader heavy'>
		App Framework
		<br>
		<br>
		<span class='ui-icon ui-icon-loading spin'></span>
		<h1>Starting app</h1>

	</div>-->
    <div class="view" id="mainview">
		<div class="pages">

			<div style="padding:0" data-left-drawer="left" class="panel" id="main" data-title="Main" data-selected="true" data-title="الصفحة الرئيسية" style="padding-bottom:0">
			<script>
/*				$(document).ready(function(){
					$("#sis-app-header").hide();
					$("#main").bind("panelbeforeload",function(){
						$("#sis-app-header").hide();
					});
					$("#sira").bind("panelbeforeload",function(){
						$("#sis-app-header").show();
					});
				});*/
			</script>
			<style>
			@import url(engine/build/fonts/DroidArabicKufi/DroidArabicKufi.css);
			@import url(engine/build/fonts/DroidArabicNaskh/DroidArabicNaskh.css);
			.main_page_head{
				height:30vh;
				margin:0 -9px;
				background:url(img/head.jpg) no-repeat center center #0D4E77;
				background-size: 100% auto;
			}
			.istighrab_mag_list{
				height:70vh;
				overflow:hidden;
			}
			.istighrab_mag_list .mag_item{
				text-align:right;
				direction:rtl;
			}
			.istighrab_mag_list .mag_item .mag_item_in{
				position:relative;
				background:#ffffff;
				height:11.7vh;
				border-bottom:0.2vh solid #f5f6f6;
				white-space:nowrap;
			}
			.istighrab_mag_list .mag_item.mag-opened .mag_item_in{
				border-bottom:none;
			}
			.istighrab_mag_list .mag_item:last-child{
				border-bottom:none;
			}
			.istighrab_mag_list .mag_item .mag-name{
				position:absolute;
				top:35%;
				right:2.5%;
			}
			.istighrab_mag_list .mag_item .mag-name .mag-name-logo{
				height:3.5vh;
			}
			.istighrab_mag_list .mag_item .mag-name .mag-name-num{
				position:absolute;
				top:-50%;
				left:-11.5%;
				width:37%;
				text-align:center;
				font-size:3.3vh;
				color:#fb8472;
				letter-spacing:-0.5vh;
				font-family:"hacen_screen";
			}
			.istighrab_mag_list .mag_item .mag-title-middle-holder{
				height:100%;
				display:inline-block;
				vertical-align:middle;
				widows:0;
				font-size:0;
			}
			.istighrab_mag_list .mag_item .mag-title{
				display:inline-block;
				margin:0 17.5vh 0 10.5vh;
				padding:0.5vh 0 0 0;
				vertical-align:middle;
				white-space:normal;
				font-family:"hacen_screen";
				font-size:2.2vh;
				color:#7e99a7;
			}
			.istighrab_mag_list .mag_item .mag-download{
				position:absolute;
				top:33%;
				left:3%;
				text-decoration:none;
				font-size:5vh;
				color:#c8d1d9;
			}
			.istighrab_mag_list .mag_item .mag-details{
				display:none;
				position:relative;
				background:#faf9f9;
				border-top:0.2vh solid #efefef;
				border-bottom:0.2vh solid #efefef;
			}
			.istighrab_mag_list .mag_item .mag-details-up-arrow{
				display:none;
				border:2.3vh solid transparent;
				border-bottom-color:#f5f5f5;
				width:0;
				height:0;
				position:absolute;
				bottom:-0.4vh;
				right:6vh;
				z-index:+1;
			}
			.istighrab_mag_list .mag_item .mag-details-up-arrow.under{
				border-bottom-color:#efefef;
				bottom:-0.1vh;
			}
			.istighrab_mag_list .mag_item.mag-opened .mag-details-up-arrow{
				display:block;
			}
			.istighrab_mag_list .mag_item.mag-opened .mag-details{
				display:block;
			}
			.istighrab_mag_list .mag_item .mag-details .mag-details-top-button{
				background:#f5f5f5;
				border-bottom:0.2vh solid #efefef;
				text-align:left;
				font-size:0;
				padding:0 0 0 1.7vh;
			}
			.istighrab_mag_list .mag_item .mag-details .mag-details-top-button a{
				display:inline-block;
				text-decoration:none;
				background:#dee2e6;
				font-family:"hacen_screen";
				font-size: 2.1vh;
				border-radius:0.6vh;
				display:inline-block;
				margin:1vh 1.2vh 1.2vh 0;
				padding:1.2vh 1.5vh 0.7vh 1.7vh;
				text-align:right;
				color:#8f9fad;
			}
			.istighrab_mag_list .mag_item .mag-details .mag-details-top-button a i.fa{
				color:#8f9fad;
				font-size:3.4vh;
				margin:0.1vh 0 0 0.3vh;
				display:inline-block;
				vertical-align:middle;
			}
			.istighrab_mag_list .mag_item .mag-details .mag-details-top-button a:first-child i.fa{
				font-size:3vh;
			}
			.istighrab_mag_list .mag_item .mag-details .mag-details-top-button a span{
				line-height:0;
				vertical-align:middle;
			}
			.istighrab_mag_list .mag_item .mag-details .mag-info .mag-info-win{
				font-size:1.7vh;
				border:1px solid #eeeeee;
				font-family:"Droid Arabic Naskh";
				background:#fff;
				margin:1.6vh;
			}
			.istighrab_mag_list .mag_item .mag-details .mag-info .mag-info-win .mag-info-win-title{
				color:#995454;
				background:#faf9f9;
				text-align:center;
				font-family:"Droid Arabic Kufi";
				font-weight:bold;
				font-size:1.6vh;
				border-bottom:1px solid #eeeeee;
				padding:1.8vh 0 1.8vh 0;
			}
			.istighrab_mag_list .mag_item .mag-details .mag-info .mag-info-win .mag-info-win-text{
				padding:2vh;
				height:33vh;
				overflow:scroll;
				color:#7b7b7b;
			}
			.istighrab_mag_list .mag_item .mag-details .mag-info p{
				padding:0;
				margin:0;
				line-height:4.2vh;
				font-size:1.7vh;
			}
		
			
		
		
		
		
		
		
		
		
		
		
			.istighrab_mag_list .mag_item .mag-details .mag-taqarir table.HHH-table{
				border-collapse:collapse;
				border:0.2vh solid #eeeeee;
				font-family:"Droid Arabic Kufi";
				color:#7b7b7b;
				margin:1.6vh;
			}
			.istighrab_mag_list .mag_item .mag-details .mag-taqarir table.HHH-table thead{
				border-bottom:0.2vh solid #eeeeee;
			}
			.istighrab_mag_list .mag_item .mag-details .mag-taqarir table.HHH-table thead tr{
				font-size:0;
			}
			.istighrab_mag_list .mag_item .mag-details .mag-taqarir table.HHH-table thead tr th{
				width:32%;
				display:inline-block;
				box-sizing:border-box;
				font-size:1.6vh;
				border:none;
				color:#995454;
				background:#faf9f9;
				text-align:right;
				padding:2vh 2vh 1.8vh 0;
				vertical-align:top;
			}
			.istighrab_mag_list .mag_item .mag-details .mag-taqarir table.HHH-table thead tr th:first-child{
				width:50%;
			}
			.istighrab_mag_list .mag_item .mag-details .mag-taqarir table.HHH-table thead tr th:last-child{
				padding-left:2vh;
				text-align:center;
				vertical-align:middle;
				width:18%;
			}
			
			.istighrab_mag_list .mag_item .mag-details .mag-taqarir table.HHH-table tbody{
				display:block;
				height:33vh;
				overflow-y: auto;
				overflow-x: hidden;
			}
			.istighrab_mag_list .mag_item .mag-details .mag-taqarir table.HHH-table tbody tr{
				font-size:0;
				border-bottom:0.2vh solid #eeeeee;
				background:#FFFFFF;
			}
			.istighrab_mag_list .mag_item .mag-details .mag-taqarir table.HHH-table tbody tr:last-child{
				border:none
			}
			.istighrab_mag_list .mag_item .mag-details .mag-taqarir table.HHH-table tbody tr td{
				width:32%;
				box-sizing:border-box;
				font-size:1.6vh;
				text-align:right;
				padding:2vh 2vh 1.8vh 0;
				vertical-align:top;
			}
			.istighrab_mag_list .mag_item .mag-details .mag-taqarir table.HHH-table tbody tr td:first-child{
				width:50%;
			}
			.istighrab_mag_list .mag_item .mag-details .mag-taqarir table.HHH-table tbody tr td:last-child{
				padding-left:2vh;
				text-align:center;
				vertical-align:middle;
				width:18%;
			}
			.istighrab_mag_list .mag_item .mag-details .mag-taqarir table.HHH-table tbody tr td a{
				color:#7b7b7b;
				text-decoration:none;
			}
			.istighrab_mag_list .mag_item .mag-details .mag-taqarir table.HHH-table tr td:last-child i{
				font-size:3.5vh;
				color:#6fc3cb !important;
			}
			

			
			
			
			</style>
				<div class="main_page_head">
					&nbsp;
				</div>
				<div class="istighrab_mag_list">
					<style>
					.istighrab_mag_list .nano { background: #f1f1f1 !important; width: 100vw; height: 70vh; }
					.istighrab_mag_list .nano .nano-content {  }
					.istighrab_mag_list .nano .nano-pane   { background: none !important; width:1.2vw; border-radius:0; }
					.istighrab_mag_list .nano .nano-slider { background: #d4d2d2 !important; border-radius:0 !important; }
					</style>
					<div class="nano">
						<div class="nano-content" id="magListCon" firstMagInListSortNum="0" lastMagInListSortNum="0">
						
							
							
							
							
							
							
							
							
							
									<div class="mag_item mag-opened" magID="">
										<div class="mag_item_in">
											<div class="mag-name">
												<img class="mag-name-logo" src="img/mag-list-logo.png" />
												<div class="mag-name-num">8</div>
											</div>
											<div class="mag-title-middle-holder">&nbsp;</div>
											<div class="mag-title">
												afdsfadsfad
											</div>
											<a class="mag-download fa fa-cloud-download" aria-hidden="true" href="#" onclick="openUrl(\'http://istighrab.iicss.iq/' +val['pdf_path'] +'\', \'system\');return false;"></a>
											<div class="mag-details-up-arrow under"></div><div class="mag-details-up-arrow"></div>
										</div>
										<div class="mag-details">
											<div class="mag-details-top-button">
												<a href="#"><i class="fa fa-align-right" aria-hidden="true"></i> <span>تفاصيل العدد</span></a>
												<a href="#"><i class="fa fa-pencil-square-o" aria-hidden="true"></i> <span>ابحاث العدد</span></a>
											</div>
											<div class="mag-taqarir" style="display:none;">

												<table class="HHH-table">
													<thead>
														<tr>
															<th>عنوان البحث</th>
															<th>الباحث</th>
															<th>تحمیل</th>
														</tr>
													</thead>
													<tbody id="magInveCon"></tbody>
												</table>

											</div>
											<div class="mag-info">

												<div class="mag-info-win">
													<div class="mag-info-win-title">معلومات العدد</div>
													<div class="mag-info-win-text" id="magTextCon"></div>
												</div>

											</div>
										</div>
									</div>
									
									
									
									
									
									
									
									
									
									
									
									
									


							
						</div>
					</div>
				</div>

			
			
			
			
			
			
			
			
				<style>
					.pic-item{
						display:block;
						background:#fcfdfe;
						border:1px solid #eaeef1;
						margin:8px 0 0 0;
						height:84px;
						box-shadow: 0 1px 1px rgba(0, 0, 0, 0.05);
						text-decoration:none;
					}
				</style>
				<script>
	function notifyaa(text, type, duration, pos, animateIn, animateOut){
/*		var n = noty({
			text: text,
			type: type,
			dismissQueue: true,
			layout: pos,
			theme: 'defaultTheme',
			animation: {
			open: {opacity: 'toggle'},
			close: {opacity: 'toggle'},
			easing: 'swing',
			speed: 700
			},
			timeout: duration,
			modal: false
		});
		return n;*/
		
		
		
		
		var n = noty({
			text         : text,
			type         : type,
			dismissQueue : true,
			layout       : pos,
			closeWith    : ['click'],
			theme        : 'relax',
			maxVisible   : 10,
			timeout      : duration,
			animation    : {
				open       : 'animated bounceIn'+animateIn,
				close      : 'animated bounceOut'+animateOut,
				easing     : 'swing',
				speed      : 500,
			}
		});
		return n;
	}
				
				
				
	var text_a = "<div class='noty-icon icon message message'>&nbsp;</div><div class='noty-close icon close message'>&nbsp;</div><div class='noty-text'>في الثالث من شهر شباط عام 2015، صدم العالم بمشاهدة فيلم من انتاج تنظيم (داعش) نشره على شبكة الانترنت، يحتوي على مشاهد وحشية لم يعتد الناس مشاهدتها من قبل، اذ اقدم التنظيم على تصوير فيلم تسجيلي يتضمن احراق انسان وهو حي، وهو طيار أردني يدعى (معاذ صافي الكساسبة- 26 عاما) وقع أسيراً بأيدي التنظيم اثر سقوط طائرته</div>";
				</script>
				<style>
					.noty_message .noty-text{
						margin:0 0 0 0;
						direction:rtl;
						text-align:justify;
						line-height:23px;
						margin:0 50px 0 5px;
					}
					.noty_message .noty-icon{
						float:right;
						width:42px;
						text-align:left;
						font-size:25px;
						padding:15px 0 0 0;
					}
					.noty_message .noty-close{
						position:absolute;
						bottom:10px;
						right:12px;
						width:42px;
						text-align:left;
						font-size:18px;
						padding:13px 0 13px 0;
						color:#333;
					}
				</style>
<!--				<a href="#" onClick="notifyaa(text_a, 'information', 8000000000, 'top', 'Left', 'Right')" class="pic-item" style=" background-image:url(pic1.jpg); background-position:right top; background-repeat:no-repeat">
					&nbsp;
				</a>
				<a href="#" class="pic-item" style=" background-image:url(pic2.jpg); background-position:right top; background-repeat:no-repeat">
					&nbsp;
				</a>
				<a href="#" class="pic-item" style=" background-image:url(pic1.jpg); background-position:right top; background-repeat:no-repeat">
					&nbsp;
				</a>
				<a href="#" class="pic-item" style=" background-image:url(pic2.jpg); background-position:right top; background-repeat:no-repeat">
					&nbsp;
				</a>
				<a href="#" class="pic-item" style=" background-image:url(pic1.jpg); background-position:right top; background-repeat:no-repeat">
					&nbsp;
				</a>
				<a href="#" class="pic-item" style=" background-image:url(pic2.jpg); background-position:right top; background-repeat:no-repeat">
					&nbsp;
				</a>
				<a href="#" class="pic-item" style=" background-image:url(pic1.jpg); background-position:right top; background-repeat:no-repeat">
					&nbsp;
				</a>
				<a href="#" class="pic-item" style=" background-image:url(pic2.jpg); background-position:right top; background-repeat:no-repeat">
					&nbsp;
				</a>
				<a href="#" class="pic-item" style=" background-image:url(pic1.jpg); background-position:right top; background-repeat:no-repeat">
					&nbsp;
				</a>-->
				
				
				
				
				
				<!--<ul id="app-status-ul">
					<li>Start</li>	 
				</ul>-->
				
				
				
				
			</div>
			
			
			
			
			
			
			<div class="panel" id="sira" data-include="include/sira.html" data-title="السيرة الذاتية" >
			
            </div>
			
			<div class="panel" id="makatib" data-include="include/makatib.html" data-title="مكاتب المرجعية" >
			
            </div>
			
			<div class="panel" id="moalafat_taqarir" data-include="include/moalafat_taqarir.html" data-title="مكاتب المرجعية" >
			
            </div>
			
			<div class="panel" id="contact_us" data-include="include/contact_us.html" data-title="إتصل بنا" >
			
            </div>
			
			<div class="panel" id="our_sites" data-include="include/our_sites.html" data-title="المواقع التابعة" >
				
            </div>
			
			<div class="panel" id="marakiz_moasisat" data-include="include/marakiz_moasisat.html" data-title="المواقع التابعة" >
				
            </div>
			
			<div class="panel" id="kotob_fatwaiya" data-include="include/kotob_fatwaiya.html" data-title="كتب فتوائية" >
				
            </div>
			
			<div class="panel" id="istiftaat" data-include="include/istiftaat.html" data-title="إستفتاءات" >
				
            </div>
			
			
			
			

		</div>
		<script>
			$(document).ready(function(){
				$("nav#right").bind("swipeRight",function(){
					$.afui.drawer.hide('#right','right');
				});
				$("nav#left").bind("swipeLeft",function(){
					$.afui.drawer.hide('#left','left');
				});
			});
		</script>
		 <nav id="right">
<!--		 	<div style="background:#09090b;height:59px;text-align:center;opacity:0.7;">
				<img src="engine/build/img/logo.png" style="margin:8px 0 0 2px;" onload="this.width/=1.9;this.onload=null;" />
			</div>
			<ul class="list">
				<li><a href="#main" class="icon home" onClick="$.afui.drawer.hide('#right','right')">الرئيسية</a></li>
			</ul>-->
			<div class="view active" style="background:none">
                <div style="background:#e6e4e4;height:59px;text-align:center;opacity:0.7;">
					<img src="engine/build/img/logo.png" style="margin:14px 3px 0 0;width:93%;" />
				</div>
                <div class="pages" style="background:none">
                    <div class="panel active" style="background:none;padding:0;">
                       
					   <ul class="list">
							<li><a href="#main" class="icon home" onClick="$.afui.drawer.hide('#right','right')">الرئيسية</a></li>
							<li><a href="#sira" class="icon stack" onClick="$.afui.drawer.hide('#right','right')">السيرة الذاتية</a></li>
							<li><a href="#moalafat_taqarir" class="icon camera" onClick="$.afui.drawer.hide('#right','right')">المؤلفات والتقريرات</a></li>
							<li><a href="#kotob_fatwaiya" class="icon camera" onClick="$.afui.drawer.hide('#right','right')">الكتب الفتوائية</a></li>
							<li><a href="#istiftaat" class="icon question" onClick="$.afui.drawer.hide('#right','right')">الإستفتاءات</a></li>
							<li><a href="#" class="icon mail" onClick="$.afui.drawer.hide('#right','right')">إرسال إستفتاء</a></li>
							<li><a href="#" class="icon message" onClick="$.afui.drawer.hide('#right','right')">البيانات الصادرة</a></li>
							<li><a href="#marakiz_moasisat" class="icon pin" onClick="$.afui.drawer.hide('#right','right')">المراكز والمؤسسات</a></li>
							<li><a href="#" class="icon pin" onClick="$.afui.drawer.hide('#right','right')">الخدمات</a></li>
							<li><a href="#our_sites" class="icon pin" onClick="$.afui.drawer.hide('#right','right')">المواقع التابعة</a></li>
							<li><a href="#" class="icon pin" onClick="$.afui.drawer.hide('#right','right')">أرشيف الموقع</a></li>
							<li><a href="#makatib" class="icon pin" onClick="$.afui.drawer.hide('#right','right')">مكاتب المرجعية</a></li>
							<li><a href="#contact_us" class="icon phone" onClick="$.afui.drawer.hide('#right','right')">إتصل بنا</a></li>
						</ul>
					   
                    </div>
                </div>
            </div>
		 </nav>
		 <nav id="left">
		 	menu left
		 </nav>
		
	</div>

	
	
</div>
</body>

</html>